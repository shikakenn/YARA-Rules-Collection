/*
    Yara Rule Set
    Author: Florian Roth
    Date: 2015-06-23
    Identifier: CN-PentestSet
*/

/* Rule Set ----------------------------------------------------------------- */

rule CN_Honker_MAC_IPMAC {
    meta:
        id = "XY99UrjDK1W8CbEi9OzZp"
        fingerprint = "v1_sha256_395dfb840346bbf3f68fa198e76349cf65c703b28fd168b85d846d07df1845fe"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file IPMAC.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "24d55b6bec5c9fff4cd6f345bacac7abadce1611"

    strings:
        $s1 = "Http://Www.YrYz.Net" fullword wide
        $s2 = "IpMac.txt" fullword ascii
        $s3 = "192.168.0.1" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 267KB and all of them
}

rule CN_Honker_GetSyskey {
    meta:
        id = "3dHcSDZyEVVu6TgzCfupJQ"
        fingerprint = "v1_sha256_1f12ea9d62d4aaf695328fb335445f3dae3996595402586d2ee52098e6727d10"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file GetSyskey.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "17cec5e75cda434d0a1bc8cdd5aa268b42633fe9"

    strings:
        $s2 = "GetSyskey <SYSTEM registry file> [Output system key file]" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "The system key file \"%s\" is created." fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 40KB and all of them
}

rule CN_Honker_Churrasco {
    meta:
        id = "78mWOAHFqqvBEWsaob25eL"
        fingerprint = "v1_sha256_f60589bda76367578388cbe6af912c80c9364a7047ed52ca2b4156a1b277e7ca"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Churrasco.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5a3c935d82a5ff0546eff51bb2ef21c88198f5b8"

    strings:
        $s0 = "HEAD9 /" ascii
        $s1 = "logic_er" fullword ascii
        $s6 = "proggam" fullword ascii
        $s16 = "DtcGetTransactionManagerExA" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 12 times */
        $s17 = "GetUserNameA" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 305 times */
        $s18 = "OLEAUT" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 1276KB and all of them
}

rule CN_Honker_mysql_injectV1_1_Creak {
    meta:
        id = "2loIghQ1GLH3gagbvnGThu"
        fingerprint = "v1_sha256_f61557216a7e90ff9655ad8aea4a9adf0e4435c7a3f7958423e46fd2265bad07"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file mysql_injectV1.1_Creak.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a1f066789f48a76023598c5777752c15f91b76b0"

    strings:
        $s0 = "1http://192.169.200.200:2217/mysql_inject.php?id=1" fullword ascii /* PEStudio Blacklist: strings */
        $s12 = "OnGetPassword" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 5890KB and all of them
}

rule CN_Honker_ASP_wshell {
    meta:
        id = "46xhBjYGduTh7NvJHNw0uc"
        fingerprint = "v1_sha256_f6f83acb76248a1b00f1acac621e68888c93b34d4813d8f8613d5d9095c53a8a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file wshell.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3ae33c835e7ea6d9df74fe99fcf1e2fb9490c978"

    strings:
        $s0 = "<%@ LANGUAGE = VBScript.Encode %><%" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "UserPass="
        $s2 = "VerName="
        $s3 = "StateName="
    condition:
        uint16(0) == 0x253c and filesize < 200KB and all of them
}

rule CN_Honker_exp_iis7 {
    meta:
        id = "5JMN45Aky3TsNyyZKR6iE"
        fingerprint = "v1_sha256_91ceec96297e5cc027e261fd708899787b9be4ac15e209e0734a3b8563ae31b5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file iis7.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0a173c5ece2fd4ac8ecf9510e48e95f43ab68978"

    strings:
        $s0 = "\\\\localhost" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "iis.run" fullword ascii
        $s3 = ">Could not connecto %s" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "WinSta0\\Default" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 22 times */
    condition:
        uint16(0) == 0x5a4d and filesize < 60KB and all of them
}

rule CN_Honker_SegmentWeapon {
    meta:
        id = "5XN7ETDojsIwiu4HmX00O"
        fingerprint = "v1_sha256_9afb70a3ae158b7abbda6725b8c9901121b78fa0e874db12b4ac08bf59b26fb5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SegmentWeapon.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "494ef20067a7ce2cc95260e4abc16fcfa7177fdf"

    strings:
        $s0 = "C:\\WINDOWS\\system32\\msvbvm60.dll\\3" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "http://www.nforange.com/inc/1.asp?" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 100KB and all of them
}

rule CN_Honker_Alien_iispwd {
    meta:
        id = "FqrEX8JcVfapHg7OgsbBP"
        fingerprint = "v1_sha256_16dc6ec4b668fdc43e3a9a8ea31ad0caa1a80b1015ab60eec0eb76bfacd69c5f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file iispwd.vbs"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5d157a1b9644adbe0b28c37d4022d88a9f58cedb"

    strings:
        $s0 = "set IIs=objservice.GetObject(\"IIsWebServer\",childObjectName)" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "wscript.echo \"from : http://www.xxx.com/\" &vbTab&vbCrLf" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 3KB and all of them
}

rule CN_Honker_Md5CrackTools {
    meta:
        id = "3XLD84AwdByVrOBqzUI4Ph"
        fingerprint = "v1_sha256_a176393c0324bcc634a31c261aa6b528fb5a5893c40a5534b34253a1922c8285"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Md5CrackTools.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "9dfd9c9923ae6f6fe4cbfa9eb69688269285939c"

    strings:
        $s1 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" fullword ascii /* PEStudio Blacklist: agent */
        $s2 = ",<a href='index.php?c=1&type=md5&hash=" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 4580KB and all of them
}

rule CN_Honker_CoolScan_scan {
    meta:
        id = "79yMYchKixYUOS9qi42KjK"
        fingerprint = "v1_sha256_89c7d24d821e907f79ab5630eed13275c5216cff6bf203b5c8f66bb1a178039b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file scan.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e1c5fb6b9f4e92c4264c7bea7f5fba9a5335c328"

    strings:
        $s0 = "User-agent:\\s{0,32}(huasai|huasai/1.0|\\*)" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "scan web.exe" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3680KB and all of them
}

rule CN_Honker_mempodipper2_6 {
    meta:
        id = "5t0m3ppjPzTvcTY7E4YafY"
        fingerprint = "v1_sha256_1a2c42757199818b94a73b9faff3380911655992ef3214a33a220eac15850c4b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file mempodipper2.6.39"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ba2c79911fe48660898039591e1742b3f1a9e923"

    strings:
        $s0 = "objdump -d /bin/su|grep '<exit@plt>'|head -n 1|cut -d ' ' -f 1|sed" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 30KB and all of them
}

rule CN_Honker_COOKIE_CooKie {
    meta:
        id = "6uQeIgj0JeGA13uxwRmT8U"
        fingerprint = "v1_sha256_6d942e53a253cb157e535f86ca457c93a6039b2c5ebb3969dc3e271242b478d4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file CooKie.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f7727160257e0e716e9f0cf9cdf9a87caa986cde"

    strings:
        $s4 = "-1 union select 1,username,password,4,5,6,7,8,9,10 from admin" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "CooKie.exe" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 360KB and all of them
}

rule CN_Honker_wwwscan_1_wwwscan {
    meta:
        id = "DqVK5zdc8JIr2k53akj8X"
        fingerprint = "v1_sha256_7b0b6bbcba49c8f950ea3cf5a364059ba784c87a41eba6d825a9ca4e3a07bfbc"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file wwwscan.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "6bed45629c5e54986f2d27cbfc53464108911026"

    strings:
        $s0 = "%s www.target.com -p 8080 -m 10 -t 16" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "GET /nothisexistpage.html HTTP/1.1" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 180KB and all of them
}

rule CN_Honker_D_injection_V2_32 {
    meta:
        id = "4YnOPAyqSLlKKeB3TPdrSC"
        fingerprint = "v1_sha256_0107903a481b09faa92a5fbb162fd981f976ed864be3a0840b43063461e20974"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file D_injection_V2.32.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3a000b976c79585f62f40f7999ef9bdd326a9513"

    strings:
        $s0 = "Missing %s property(CommandText does not return a result set{Error creating obje" wide /* PEStudio Blacklist: strings */
        $s1 = "/tftp -i 219.134.46.245 get 9493.exe c:\\9394.exe" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 5000KB and all of them
}

rule CN_Honker_net_priv_esc2 {
    meta:
        id = "3CrxdHRTjveHr4tjs1vTI9"
        fingerprint = "v1_sha256_53cf3d984bc82428eb0a6ee416bcd5429718a1d615ce1c1ba399cda42268d26c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file net-priv-esc2.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4851e0088ad38ac5b3b1c75302a73698437f7f17"

    strings:
        $s1 = "Usage:%s username password" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "<www.darkst.com>" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 17KB and all of them
}

rule CN_Honker_Oracle_v1_0_Oracle {
    meta:
        id = "2af7y7Rs4eDX92Q8R0hZQh"
        fingerprint = "v1_sha256_6f1bb6b14445a9ca29768ab2dcf831a98cb5d153d03ebc4bc497bb8f8144a365"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Oracle.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0264f4efdba09eaf1e681220ba96de8498ab3580"

    strings:
        $s1 = "!http://localhost/index.asp?id=zhr" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "OnGetPassword" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Mozilla/3.0 (compatible; Indy Library)" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3455KB and all of them
}

rule CN_Honker_Interception {
    meta:
        id = "3LLVflkvJZwTveKcWkliUU"
        fingerprint = "v1_sha256_d1ae5f8ff21659b95f6e62b1d5e3ec15b122a2b5889e8984f3d9f6d2fa938d17"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Interception.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ea813aed322e210ea6ae42b73b1250408bf40e7a"

    strings:
        $s2 = ".\\dat\\Hookmsgina.dll" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "WinlogonHackEx " fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 160KB and all of them
}

rule CN_Honker_sig_3389_DUBrute_v3_0_RC3_3_0 {
    meta:
        id = "4m0B0nP9hlFyrAD5rpuTMX"
        fingerprint = "v1_sha256_6d2f6721c942332af1be0b6537e9b9d0b5b3e91eb3912dcd095aa18bccfc4ad5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file 3.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "49b311add0940cf183e3c7f3a41ea6e516bf8992"

    strings:
        $s0 = "explorer.exe http://bbs.yesmybi.net" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "LOADER ERROR" fullword ascii /* PEStudio Blacklist: strings */
        $s9 = "CryptGenRandom" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 581 times */
    condition:
        uint16(0) == 0x5a4d and filesize < 395KB and all of them
}

rule CN_Honker_windows_exp {
    meta:
        id = "3pPUUCIcB0Mdmeh3F3X1Qo"
        fingerprint = "v1_sha256_6a146545fd12e7603bf1e2ccb9b2d308b13fe2acdb9248a79c80b6c1de37fd73"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file exp.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "04334c396b165db6e18e9b76094991d681e6c993"

    strings:
        $s0 = "c:\\windows\\system32\\command.com /c " fullword ascii /* PEStudio Blacklist: strings */
        $s8 = "OH,Sry.Too long command." fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 220KB and all of them
}

rule CN_Honker_safe3wvs_cgiscan {
    meta:
        id = "5xMmluCM2FZJIa7yA8SPu7"
        fingerprint = "v1_sha256_990dcede3bb83216af7e72e2a49bc2355ebd45ebd3fc658ba337a285dcdf799f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file cgiscan.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f94bbf2034ad9afa43cca3e3a20f142e0bb54d75"

    strings:
        $s2 = "httpclient.exe" fullword wide
        $s3 = "www.safe3.com.cn" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 357KB and all of them
}

rule CN_Honker_pr_debug {
    meta:
        id = "4j7mYm5KnTlchkQEft8lhq"
        fingerprint = "v1_sha256_0b7508e3a508adc9416f16549290e06468520c156dbd5192e5a352820586af9f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file debug.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "d11e6c6f675b3be86e37e50184dadf0081506a89"

    strings:
        $s1 = "-->Got WMI process Pid: %d " ascii /* PEStudio Blacklist: strings */
        $s2 = "This exploit will execute \"net user temp 123456 /add & net localg" ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 820KB and all of them
}

rule CN_Honker_T00ls_Lpk_Sethc_v4_0 {
    meta:
        id = "1qqI6sbyuXxNrUOjVJMfZb"
        fingerprint = "v1_sha256_bd6f9b6e831573164fddf7f0188087eb0076410b77c9c06cfacadebe6a53b525"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v4.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "98f21f72c761e504814f0a7db835a24a2413a6c2"

    strings:
        $s0 = "LOADER ERROR" fullword ascii /* PEStudio Blacklist: strings */
        $s15 = "2011-2012 T00LS&RICES" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 2077KB and all of them
}

rule CN_Honker_MatriXay1073 {
    meta:
        id = "6MR8R8dhQItnSkOG31ZNKE"
        fingerprint = "v1_sha256_8b7cf7abcd12386debb0b5f369de759e0c0d6c564bd0faf385fbae3cbedd4e36"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file MatriXay1073.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "fef951e47524f827c7698f4508ba9551359578a5"

    strings:
        $s0 = "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1" ascii /* PEStudio Blacklist: strings */
        $s1 = "Policy\\Scan\\GetUserLen.ini" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "!YEL!Using http://127.0.0.1:%d/ to visiter https://%s:%d/" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "getalluserpasswordhash" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 9100KB and all of them
}

rule CN_Honker_Sword1_5 {
    meta:
        id = "5qOeGGrAm5GTCMWsH8c6mL"
        fingerprint = "v1_sha256_6b2f2e5aea5dc4aa4939099f56435ceb9f01210dcc3274b1913c0b92bf2ff4d2"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Sword1.5.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "96ee5c98e982aa8ed92cb4cedb85c7fda873740f"

    strings:
        $s1 = "http://www.md5.com.cn" fullword wide
        $s2 = "ListBox_Command" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "\\Set.ini" fullword wide
        $s4 = "OpenFileDialog1" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 740KB and all of them
}

rule CN_Honker_Havij_Havij {
    meta:
        id = "6oelnakG9s4yUP9SPQqnzF"
        fingerprint = "v1_sha256_e8aff3e1e536cd35b10bdaab4818542bce284e7ed3aa7ef1920763669faf4c8a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Havij.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0d8b275bd1856bc6563dd731956f3b312e1533cd"

    strings:
        $s1 = "User-Agent: %Inject_Here%" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "BACKUP database master to disk='d:\\Inetpub\\wwwroot\\1.zip'" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3000KB and all of them
}

rule CN_Honker_exp_ms11011 {
    meta:
        id = "6qWeMyV0bprNBajisfcPMK"
        fingerprint = "v1_sha256_f92d71f163a49a158d85b821d71fd17e84e0d3deb19515ae0cf6a063a05c027b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ms11011.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5ad7a4962acbb6b0e3b73d77385eb91feb88b386"

    strings:
        $s0 = "\\i386\\Hello.pdb" ascii /* PEStudio Blacklist: strings */
        $s1 = "OS not supported." fullword ascii /* PEStudio Blacklist: strings */
        $s2 = ".Rich5" fullword ascii
        $s3 = "Not supported." fullword wide /* PEStudio Blacklist: strings */ /* Goodware String - occured 3 times */
        $s5 = "cmd.exe" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 120 times */
    condition:
        uint16(0) == 0x5a4d and filesize < 100KB and all of them
}

rule CN_Honker_DLL_passive_privilege_escalation_ws2help {
    meta:
        id = "6qxIEMtR1ALsEca50o4XaP"
        fingerprint = "v1_sha256_a4ab271c36b0ef60ccaea5d318fe1892cacbf122c37d1651d66bc0e6b1d6ce5a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ws2help.dll"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e539b799c18d519efae6343cff362dcfd8f57f69"

    strings:
        $s0 = "PassMinDll.dll" fullword ascii
        $s1 = "\\ws2help.dll" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 30KB and all of them
}

rule CN_Honker_Webshell {
    meta:
        id = "2PX3nmoiYs5kELP1TitUVf"
        fingerprint = "v1_sha256_d48a10313afcb5a2084229937703bbc11958a5cd11f8f27fbc8dae15ddfd5ed1"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Webshell.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c85bd09d241c2a75b4e4301091aa11ddd5ad6d59"

    strings:
        $s1 = "Windows NT users: Please note that having the WinIce/SoftIce" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Do you want to cancel the file download?" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Downloading: %s" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 381KB and all of them
}

rule CN_Honker_AspxClient {
    meta:
        id = "2rz5EGewJaeXMFE9BmrRPu"
        fingerprint = "v1_sha256_b54c958ceaecceac0ced488adada5bcf2d4cc8a4d9adae9d3af9191ed662be7e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file AspxClient.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "67569a89128f503a459eab3daa2032261507f2d2"

    strings:
        $s1 = "\\tools\\hashq\\hashq.exe" fullword wide
        $s2 = "\\Release\\CnCerT.CCdoor.Client.pdb" fullword ascii
        $s3 = "\\myshell.mdb" fullword wide /* PEStudio Blacklist: strings */
        $s4 = "injectfile" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 1000KB and 3 of them
}

rule CN_Honker_Fckeditor {
    meta:
        id = "6TBGIG2W1nUWZPEHyGfk7I"
        fingerprint = "v1_sha256_0fd231fc81b2b7b5647a8016774f35751ac68646856a15c17ce4d2c07eaf1761"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Fckeditor.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4b16ae12c204f64265acef872526b27111b68820"

    strings:
        $s0 = "explorer.exe http://user.qzone.qq.com/568148075" fullword wide /* PEStudio Blacklist: strings */
        $s7 = "Fckeditor.exe" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 1340KB and all of them
}

rule CN_Honker_Codeeer_Explorer {
    meta:
        id = "5qMz9CsmjxIFQcrCBXyWcb"
        fingerprint = "v1_sha256_299d0181beb5032dcb327516a7526d6131e2212623ffa9e592f54f80473b098d"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Codeeer Explorer.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f32e05f3fefbaa2791dd750e4a3812581ce0f205"

    strings:
        $s2 = "Codeeer Explorer.exe" fullword wide /* PEStudio Blacklist: strings */
        $s12 = "webBrowser1_ProgressChanged" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 470KB and all of them
}

rule CN_Honker_SwordHonkerEdition {
    meta:
        id = "3UTbnVNcnOYRb7HQLPwX5k"
        fingerprint = "v1_sha256_29f1eb647c8d33a02d7dd57f87f97462888d481c4c16bb0d3373da65a99a24bd"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SwordHonkerEdition.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3f9479151c2cada04febea45c2edcf5cece1df6c"

    strings:
        $s0 = "\\bin\\systemini\\MyPort.ini" fullword wide /* PEStudio Blacklist: strings */
        $s1 = "PortThread=200 //" fullword wide /* PEStudio Blacklist: strings */
        $s2 = " Port Open -> " fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 375KB and all of them
}

rule CN_Honker_HASH_PwDump7 {
    meta:
        id = "3aafMRERGGaEb0HlcqeKE7"
        fingerprint = "v1_sha256_05f735ba3f377f71ccf3a97b3597cee7b9f36213ee2ebba19db69667529d9fac"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file PwDump7.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "93a2d7c3a9b83371d96a575c15fe6fce6f9d50d3"

    strings:
        $s1 = "%s\\SYSTEM32\\CONFIG\\SAM" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "No Users key!" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "NO PASSWORD*********************:" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Unable to dump file %S" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 380KB and all of them
}

rule CN_Honker_ChinaChopper {
    meta:
        id = "3QUvnePLBDYSpp1ZolCwPT"
        fingerprint = "v1_sha256_e5e6a8a17592e7c82af830153905a52f8202a65c8e2f4b09dbebb19d04e2f8d7"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ChinaChopper.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "fa347fdb23ab0b8d0560a0d20c434549d78e99b5"

    strings:
        $s1 = "$m=get_magic_quotes_gpc();$sid=$m?stripslashes($_POST[\"z1\"]):$_POST[\"z1\"];$u" wide /* PEStudio Blacklist: strings */
        $s3 = "SETP c:\\windows\\system32\\cmd.exe " fullword wide /* PEStudio Blacklist: strings */
        $s4 = "Ev al (\"Exe cute(\"\"On+Error+Resume+Next:%s:Response.Write(\"\"\"\"->|\"\"\"\"" wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 2000KB and 1 of them
}

rule CN_Honker_dedecms5_7 {
    meta:
        id = "15PoxLBnuMEHPXp4odqGMj"
        fingerprint = "v1_sha256_57ff887906d3c5e7eafc900581eea7432c7a18364b0061d0e4deba0229663c65"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file dedecms5.7.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f9cbb25883828ca266e32ff4faf62f5a9f92c5fb"

    strings:
        $s1 = "/data/admin/ver.txt" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "SkinH_EL.dll" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 830KB and all of them
}

rule CN_Honker_Alien_ee {
    meta:
        id = "2CudBFJ870i3bioY95RM"
        fingerprint = "v1_sha256_1f40f6c53e13aeb6b44c58f6e048a35cf3fd9fb956f26d70b3fe91bcac340ab5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ee.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "15a7211154ee7aca29529bd5c2500e0d33d7f0b3"

    strings:
        $s1 = "GetIIS UserName and PassWord." fullword wide /* PEStudio Blacklist: strings */
        $s2 = "Read IIS ID For FreeHost." fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 50KB and all of them
}

rule CN_Honker_smsniff_smsniff {
    meta:
        id = "5VH9cpjfz8WBtK4eQb0e5i"
        fingerprint = "v1_sha256_6949f992d4734f18d9caffe83f2abccca0e0decef4169954518eed078d39e561"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file smsniff.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "8667a785a8ced76d0284d225be230b5f1546f140"

    strings:
        $s1 = "smsniff.exe" fullword wide
        $s5 = "SmartSniff" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 267KB and all of them
}

rule CN_Honker_Happy_Happy {
    meta:
        id = "6ho3tgMaqUiFy1uw5fNnNQ"
        fingerprint = "v1_sha256_5ac6ae030043c2646f376b1eb0c88522bc1bc10c581fce47b8e56ffbd1dc462e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Happy.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "92067d8dad33177b5d6c853d4d0e897f2ee846b0"

    strings:
        $s1 = "<form.*?method=\"post\"[\\s\\S]*?</form>" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "domainscan.exe" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "http://www.happysec.com/" fullword wide
        $s4 = "cmdshell" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 655KB and 2 of them
}

rule CN_Honker_T00ls_Lpk_Sethc_v3_0 {
    meta:
        id = "7cicRkVaDqZrcETxKsILEO"
        fingerprint = "v1_sha256_fa65de4a135072f4d9a5d5711a4e2833b9d4a268a2a37c33d17e4546d172b6f1"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v3.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "fa47c4affbac01ba5606c4862fdb77233c1ef656"

    strings:
        $s1 = "http://127.0.0.1/1.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = ":Rices  Forum:T00Ls.Net  [4 Fucker Te@m]" fullword wide
        $s3 = "SkinH_EL.dll" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 1000KB and 2 of them
}

rule CN_Honker_NetFuke_NetFuke {
    meta:
        id = "xqfdjCoI3rvUAznDfs9Pl"
        fingerprint = "v1_sha256_86f6040b743b17fb300498b02a202d1a9090054a30d490f082b116d799c4bdb2"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file NetFuke.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f89e223fd4f6f5a3c2a2ea225660ef0957fc07ba"

    strings:
        $s1 = "Mac Flood: Flooding %dT %d p/s " fullword ascii
        $s2 = "netfuke_%s.txt" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 1840KB and all of them
}

rule CN_Honker_ManualInjection {
    meta:
        id = "23yNKvlXz96YQKQwOzBh5O"
        fingerprint = "v1_sha256_fe8eba3b79f5bc4cf820ff51816c3f2a27d6ed8f6ab3963f88a3232c9a4b5c1e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ManualInjection.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e83d427f44783088a84e9c231c6816c214434526"

    strings:
        $s0 = "http://127.0.0.1/cookie.asp?fuck=" fullword ascii /* PEStudio Blacklist: strings */
        $s16 = "http://Www.cnhuker.com | http://www.0855.tv" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 3000KB and all of them
}

rule CN_Honker_CnCerT_CCdoor_CMD {
    meta:
        id = "6rtMVVrdfj6YQFR4wYakvq"
        fingerprint = "v1_sha256_3c068c3d21de8c071b3eec354f03423d4902ef0156bb9dcad370cf688bc03426"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "1c6ed7d817fa8e6534a5fd36a94f4fc2f066c9cd"

    strings:
        $s2 = "CnCerT.CCdoor.CMD.dll" fullword wide
        $s3 = "cmdpath" fullword ascii
        $s4 = "Get4Bytes" fullword ascii
        $s5 = "ExcuteCmd" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 22KB and all of them
}

rule CN_Honker_termsrvhack {
    meta:
        id = "6B40rlQ9FewJIeH1IF7mzL"
        fingerprint = "v1_sha256_ef0b9965e2d419230a7a8425674edb356347d1e41538d19fc67f8b0fbc69091f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file termsrvhack.dll"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "1c456520a7b7faf71900c71167038185f5a7d312"

    strings:
        $s1 = "The terminal server cannot issue a client license.  It was unable to issue the" wide /* PEStudio Blacklist: strings */
        $s6 = "%s\\%s\\%d\\%d" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 1052KB and all of them
}

rule CN_Honker_IIS6_iis6 {
    meta:
        id = "3cnzgcQsVtjjBkFDuO9pwT"
        fingerprint = "v1_sha256_51b2fdae6437d64661f20342711d516201740eceb2273704a6e415be2cac54f6"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file iis6.com"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f0c9106d6d2eea686fd96622986b641968d0b864"

    strings:
        $s0 = "GetMod;ul" fullword ascii
        $s1 = "excjpb" fullword ascii
        $s2 = "LEAUT1" fullword ascii
        $s3 = "EnumProcessModules" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 410 times */
    condition:
        uint16(0) == 0x5a4d and filesize < 50KB and all of them
}

rule CN_Honker_struts2_catbox {
    meta:
        id = "yA8oOSzbzCPicDbLS9wwJ"
        fingerprint = "v1_sha256_20bda5c918ea38810603528a20f3406ec4e79ce999681649e8e806bf549b5359"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file catbox.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ee8fbd91477e056aef34fce3ade474cafa1a4304"

    strings:
        $s6 = "'Toolmao box by gainover www.toolmao.com" fullword ascii
        $s20 = "{external.exeScript(_toolmao_bgscript[i],'javascript',false);}}" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 8160KB and all of them
}

rule CN_Honker_getlsasrvaddr {
    meta:
        id = "LtVaTcenSX0mpphXzbtur"
        fingerprint = "v1_sha256_bb40484a450ea91b66da989cada55bf140802cc659bcf8c1e1764bb3748ff110"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file getlsasrvaddr.exe - WCE Amplia Security"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a897d5da98dae8d80f3c0a0ef6a07c4b42fb89ce"

    strings:
        $s8 = "pingme.txt" fullword ascii /* PEStudio Blacklist: strings */
        $s16 = ".\\lsasrv.pdb" fullword ascii
        $s20 = "Addresses Found: " fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 100KB and all of them
}

rule CN_Honker_ms10048_x64 {
    meta:
        id = "jEHsCzAEOlDu9vHadrS51"
        fingerprint = "v1_sha256_49addce6bef7588bf7683836a54bec6a2a646ecc3f7547083174d2255454cdf0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ms10048-x64.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "418bec3493c85e3490e400ecaff5a7760c17a0d0"

    strings:
        $s1 = "[ ] Creating evil window" fullword ascii
        $s2 = "[+] Set to %d exploit half succeeded" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 125KB and all of them
}

rule CN_Honker_LogCleaner {
    meta:
        id = "3EcV8aSiko7E5aL918jMW8"
        fingerprint = "v1_sha256_3be059627c39e262e7621fce637df21ddcabef91753192cec356f2f8cd58c1a3"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file LogCleaner.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ab77ed5804b0394d58717c5f844d9c0da5a9f03e"

    strings:
        $s3 = ".exe <ip> [(path]" fullword ascii
        $s4 = "LogCleaner v" ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 250KB and all of them
}

rule CN_Honker_shell_brute_tool {
    meta:
        id = "5QrK3R27iEq9L3cb20x5xf"
        fingerprint = "v1_sha256_723fd18e59c0017b67a035ec7c685169c517d673c2bbc8fe93071b8dbd1e606a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file shell_brute_tool.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f6903a15453698c35dce841e4d09c542f9480f01"

    strings:
        $s0 = "http://24hack.com/xyadmin.asp" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" fullword ascii /* PEStudio Blacklist: agent */
    condition:
        uint16(0) == 0x5a4d and filesize < 1000KB and all of them
}

rule CN_Honker_hxdef100 {
    meta:
        id = "1okpcge2Q4M4OnZ14NWH37"
        fingerprint = "v1_sha256_49f15482104297f0c57713712a7add49d58007afeefd11151dc5749b755860ba"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file hxdef100.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "bf30ccc565ac40073b867d4c7f5c33c6bc1920d6"

    strings:
        $s6 = "BACKDOORSHELL" fullword ascii /* PEStudio Blacklist: strings */
        $s15 = "%tmpdir%" fullword ascii
        $s16 = "%cmddir%" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker_Arp_EMP_v1_0 {
    meta:
        id = "5AWie1UmaRUh9vbr95V4Sg"
        fingerprint = "v1_sha256_457035b1685ac7f1bdccaab0b64bb1ad3ca1bf5e0747222347ced2a11b9b9504"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Arp EMP v1.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ae4954c142ad1552a2abaef5636c7ef68fdd99ee"

    strings:
        $s0 = "Arp EMP v1.0.exe" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 400KB and all of them
}

rule CN_Honker_GetWebShell {
    meta:
        id = "4QTgxqoiYQvBVQlAVbjhfX"
        fingerprint = "v1_sha256_5d6638596607884950e702144416eb6fd3b009c88e4af5f81a50f346d7491c95"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file GetWebShell.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b63b53259260a7a316932c0a4b643862f65ee9f8"

    strings:
        $s0 = "echo P.Open \"GET\",\"http://www.baidu.com/ma.exe\",0 >>run.vbs" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "http://127.0.0.1/sql.asp?id=1" fullword wide /* PEStudio Blacklist: strings */
        $s14 = "net user admin$ hack /add" fullword wide /* PEStudio Blacklist: strings */
        $s15 = ";Drop table [hack];create table [dbo].[hack] ([cmd] [image])--" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 70KB and 1 of them
}

rule CN_Honker_Cracker_SHELL {
    meta:
        id = "pNHZ3Yfx5K0Jj2aXYg08J"
        fingerprint = "v1_sha256_8f46ce4919f408dec9f5edda9ce559b9084a44457a6a7f252bba0b80636e12aa"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SHELL.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c1dc349ff44a45712937a8a9518170da8d4ee656"

    strings:
        $s1 = "http://127.0.0.1/error1.asp" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "password,PASSWORD,pass,PASS,Lpass,lpass,Password" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "\\SHELL" fullword wide /* PEStudio Blacklist: strings */
        $s4 = "WebBrowser1" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker_MSTSC_can_direct_copy {
    meta:
        id = "17lddldFTRSzlzdW2JzOPl"
        fingerprint = "v1_sha256_cbe3c1465b631603ad51a85b54a98e816500b5bd45e38524e9b11965f35147ed"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file MSTSC_can_direct_copy.EXE"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2f3cbfd9f82f8abafdb1d33235fa6bfa1e1f71ae"

    strings:
        $s1 = "srv\\newclient\\lib\\win32\\obj\\i386\\mstsc.pdb" fullword ascii
        $s2 = "Clear Password" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "/migrate -- migrates legacy connection files that were created with " fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 600KB and all of them
}

rule CN_Honker_lcx_lcx {
    meta:
        id = "56FaWRV562l6ZfNuF8usgY"
        fingerprint = "v1_sha256_6e81cac14baa9f0ae35eb26f30291cba6f7ef1864f8970b97a3e6e7205d10eb9"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - HTRAN - file lcx.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0c8779849d53d0772bbaa1cedeca150c543ebf38"

    strings:
        $s1 = "%s -<listen|tran|slave> <option> [-log logfile]" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "=========== Code by lion & bkbll" ascii
        $s3 = "Welcome to [url]http://www.cnhonker.com[/url] " ascii
        $s4 = "-tran   <ConnectPort> <TransmitHost> <TransmitPort>" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "[+] Start Transmit (%s:%d <-> %s:%d) ......" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 30KB and 1 of them
}

rule CN_Honker_PostgreSQL {
    meta:
        id = "6bXJqXGSw8PQ4dKIyDqR8R"
        fingerprint = "v1_sha256_f6921e7a7c88d70c77fc30dc273aac3679a3c0ab44d4d4706d7a405f16cff6a1"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file PostgreSQL.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "1ecfaa91aae579cfccb8b7a8607176c82ec726f4"

    strings:
        $s1 = "&http://192.168.16.186/details.php?id=1" fullword ascii
        $s2 = "PostgreSQL_inject" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 2000KB and all of them
}

rule CN_Honker_WebRobot {
    meta:
        id = "36MMYrwD0u3T6I7Ltw9AF0"
        fingerprint = "v1_sha256_e411265e40383f9b7b48e03647282fbf855dbeee0f7565e06c5b401282effa7c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file WebRobot.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "af054994c911b4301490344fca4bb19a9f394a8f"

    strings:
        $s1 = "%d-%02d-%02d %02d^%02d^%02d ScanReprot.htm" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "\\log\\ProgramDataFile.dat" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "\\data\\FilterKeyword.txt" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 2000KB and all of them
}

rule CN_Honker_Baidu_Extractor_Ver1_0 {
    meta:
        id = "5KynRf7JPECkGvNQWCOEhN"
        fingerprint = "v1_sha256_0c399b090c77e8139b0376bd076f75e6ce6e58b6ced7a7e7976421e568f9f2c4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Baidu_Extractor_Ver1.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "1899f979360e96245d31082e7e96ccedbdbe1413"

    strings:
        $s3 = "\\Users\\Admin" fullword wide /* PEStudio Blacklist: strings */
        $s11 = "soso.com" fullword wide
        $s12 = "baidu.com" fullword wide
        $s19 = "cmd /c ping " fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 500KB and all of them
}

rule CN_Honker_FTP_scanning {
    meta:
        id = "69uKz69g7YwtJ7EGjfdCN6"
        fingerprint = "v1_sha256_5f1c312dc9fa80c120699bacd17d5e4c147ab96f90c619a8c39ec27646a1307f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file FTP_scanning.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5a3543ee5aed110c87cbc3973686e785bcb5c44e"

    strings:
        $s1 = "CNotSupportedE" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "nINet.dll" fullword ascii
        $s9 = "?=MODULE" fullword ascii /* PEStudio Blacklist: strings */
        $s13 = "MSIE 6*" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 550KB and all of them
}

rule CN_Honker_dirdown_dirdown {
    meta:
        id = "2Yr5u0XzQ7T6FUIS7RFw7"
        fingerprint = "v1_sha256_e68f9354cf3c1606582a859eb4ab3fb5f3d25b5df9706d8076aac85e471c2dd5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file dirdown.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7b8d51c72841532dded5fec7e7b0005855b8a051"

    strings:
        $s0 = "\\Decompress\\obj\\Release\\Decompress.pdb" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "Decompress.exe" fullword wide
        $s5 = "Get8Bytes" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 45KB and all of them
}

rule CN_Honker_Xiaokui_conversion_tool {
    meta:
        id = "1pGrJ5SAkLcrG8xC4iJs0B"
        fingerprint = "v1_sha256_66a77c1fbfecdc02f591c12f69b46e39b7077dfbb5ed2a26a7dcfb11c8b464dc"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Xiaokui_conversion_tool.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "dccd163e94a774b01f90c1e79f186894e2f27de3"

    strings:
        $s1 = "update [dv_user] set usergroupid=1 where userid=2;--" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "To.exe" fullword wide
        $s3 = "by zj1244" ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 240KB and 2 of them
}

rule CN_Honker_GroupPolicyRemover {
    meta:
        id = "6NhO7xdvJzpO2s02Pjz6LI"
        fingerprint = "v1_sha256_936d5dea2d44f638abfb5e42f45c0678bcbf769b575b5056db1a1fc41d1643be"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file GroupPolicyRemover.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7475d694e189b35899a2baa462957ac3687513e5"

    strings:
        $s0 = "GP_killer.EXE" fullword wide /* PEStudio Blacklist: strings */
        $s1 = "GP_killer Microsoft " fullword wide /* PEStudio Blacklist: strings */
        $s2 = "SHDeleteKeyA" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 79 times */
    condition:
        uint16(0) == 0x5a4d and filesize < 700KB and all of them
}

rule CN_Honker_WordpressScanner {
    meta:
        id = "Oxbte2Hx8lSMqjf1JeoKp"
        fingerprint = "v1_sha256_c6c36ad5ff0ddfbc41464008d293d453bf2d312a6db885217785adf816bd8b20"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file WordpressScanner.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0b3c5015ba3616cbc616fc9ba805fea73e98bc83"

    strings:
        $s0 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" fullword ascii /* PEStudio Blacklist: agent */
        $s1 = "(http://www.eyuyan.com)" fullword wide
        $s2 = "GetConnectString" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 1000KB and all of them
}

rule CN_Honker_Htran_V2_40_htran20 {
    meta:
        id = "1jpalFLh2GYstnL79xyQfX"
        fingerprint = "v1_sha256_41a85430875df622e7940ef26c6eceaa4e0720b2995521fbb2d4b072207c8e15"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file htran20.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b992bf5b04d362ed3757e90e57bc5d6b2a04e65c"

    strings:
        $s1 = "%s -slave  ConnectHost ConnectPort TransmitHost TransmitPort" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "[SERVER]connection to %s:%d error" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "%s -connect ConnectHost [ConnectPort]       Default:%d" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "[+] got, ip:%s, port:%d" fullword ascii /* PEStudio Blacklist: strings */
        $s6 = "[-] There is a error...Create a new connection." fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker_DictionaryGenerator {
    meta:
        id = "3NIIPXAdBG91sjaJUwKdki"
        fingerprint = "v1_sha256_228bdbca3eb206e22a130e91caa2486174efba9356dbee67e80333c0cf0bb643"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file DictionaryGenerator.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b3071c64953e97eeb2ca6796fab302d8a77d27bc"

    strings:
        $s1 = "`PasswordBuilder" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "cracker" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3650KB and all of them
}

rule CN_Honker_ms11080_withcmd {
    meta:
        id = "2ukJhN4czO69tuV85e2kYU"
        fingerprint = "v1_sha256_1f673f845ad40efae143ec244c7c70d1e26fb51f22be6bf445085c6a7379f193"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ms11080_withcmd.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "745e5058acff27b09cfd6169caf6e45097881a49"

    strings:
        $s1 = "Usage : ms11-080.exe cmd.exe Command " fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "[>] create pipe error" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 340KB and all of them
}

rule CN_Honker_T00ls_Lpk_Sethc_v2 {
    meta:
        id = "6rd8NuD0BcVd1193LFDfjB"
        fingerprint = "v1_sha256_979f3fe9795798743f2a57aa3b82a34e304774de58ffda5278991cf5a753a8ba"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v2.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a995451d9108687b8892ad630a79660a021d670a"

    strings:
        $s1 = "LOADER ERROR" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "The procedure entry point %s could not be located in the dynamic link library %s" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "2011-2012 T00LS&RICES" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 800KB and all of them
}

rule CN_Honker_HASH_32 {
    meta:
        id = "5r2sQGpIh3kvTOcCNm6unm"
        fingerprint = "v1_sha256_819e70979ae1d5e237bbadaa52b504c566b4b7436747ceb0d72e206e4fc45708"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file 32.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "bf4a8b4b3e906e385feab5ea768f604f64ba84ea"

    strings:
        $s5 = "[Undefined OS version]  Major: %d Minor: %d" fullword ascii
        $s8 = "Try To Run As Administrator ..." fullword ascii /* PEStudio Blacklist: strings */
        $s9 = "Specific LUID NOT found" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 240KB and all of them
}

rule CN_Honker_windows_mstsc_enhanced_RMDSTC {
    meta:
        id = "27JiVIuLy9tgQneBHQbB3r"
        fingerprint = "v1_sha256_de676b033613beebfe9fc5a71cf5f5911f0af35d34e77d56d222c6f00114dfb6"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file RMDSTC.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3ca2b1b6f31219baf172abcc8f00f07f560e465f"

    strings:
        $s0 = "zava zir5@163.com" fullword wide
        $s1 = "By newccc" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 400KB and all of them
}

rule CN_Honker_sig_3389_mstsc_MSTSCAX {
    meta:
        id = "3KoXI7MsoqoZ2dmAhNOVYz"
        fingerprint = "v1_sha256_2bfe10ec4af5d0f32fc03714c0cb01d9b0d446daa67cc0cce0b83f6a57e7c5a5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file MSTSCAX.DLL"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2fa006158b2d87b08f1778f032ab1b8e139e02c6"

    strings:
        $s1 = "ResetPasswordWWWx" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Terminal Server Redirected Printer Doc" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "Cleaning temp directory" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 1000KB and all of them
}

rule CN_Honker_T00ls_scanner {
    meta:
        id = "63to715RbaZRUJe71AuQB6"
        fingerprint = "v1_sha256_558abb651ce410520811ca96aaad78710cb9bf597b59ed89d9a678377716d721"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file T00ls_scanner.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "70b04b910d82b32b90cd7f355a0e3e17dd260cb3"

    strings:
        $s0 = "http://cn.bing.com/search?first=1&count=50&q=ip:" fullword wide
        $s17 = "Team:www.t00ls.net" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 330KB and all of them
}

rule CN_Honker_GetHashes {
    meta:
        id = "IpZcIHbtIktyj1S0lWc5a"
        fingerprint = "v1_sha256_fb5ab5e6d8b522caf27478b0589b39d06b96fb0f913673ede768a814836e11f8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file GetHashes.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "dc8bcebf565ffffda0df24a77e28af681227b7fe"

    strings:
        $s0 = "SAM\\Domains\\Account\\Users\\Names registry hive reading error!" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "GetHashes <SAM registry file> [System key file]" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Note: Windows registry file shall begin from 'regf' signature!" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 87KB and 2 of them
}

rule CN_Honker_hashq_Hashq {
    meta:
        id = "4xqK61tSJMTnGrv6ghIkve"
        fingerprint = "v1_sha256_a71ad182f7dd33790e59badfba6149c6dea627858414f0a8f3e64fd3bb2e2a64"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Hashq.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7518b647db5275e8a9e0bf4deda3d853cc9d5661"

    strings:
        $s1 = "Hashq.exe" fullword wide
        $s5 = "CnCert.Net" fullword wide
        $s6 = "Md5 query tool" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 600KB and all of them
}

rule CN_Honker_ShiftBackdoor_Server {
    meta:
        id = "3w3hs70Mxj8G9j03orZa59"
        fingerprint = "v1_sha256_9316c43390b013b28ec2fb0a7415dd3c7b4aa4f4334edd8feec4e6f0100bf1ff"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Server.dat"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b24d761c6bbf216792c4833890460e8b37d86b37"

    strings:
        $s0 = "del /q /f %systemroot%system32sethc.exe" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "cacls %s /t /c /e /r administrators" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "\\dllcache\\sethc.exe" fullword ascii
        $s3 = "\\ntvdm.exe" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and 2 of them
}

rule CN_Honker_exp_win2003 {
    meta:
        id = "1kMVdjzOqjansv6SW3gCiO"
        fingerprint = "v1_sha256_d1616c53b26eefaa2578efb7defee182e8c88c869cfffb16c8767ddc1869ad46"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file win2003.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "47164c8efe65d7d924753fadf6cdfb897a1c03db"

    strings:
        $s1 = "Usage:system_exp.exe \"cmd\"" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "The shell \"cmd\" success!" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Not Windows NT family OS." fullword ascii /* PEStudio Blacklist: os */
    condition:
        uint16(0) == 0x5a4d and filesize < 100KB and all of them
}

rule CN_Honker_Interception3389_setup {
    meta:
        id = "2L3C0hA8jFJFihk7w6c6bc"
        fingerprint = "v1_sha256_4f32234694a84c998bb9048517e2916ebcb31901a8edd2df10140d815d4fbc60"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file setup.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f5b2f86f8e7cdc00aa1cb1b04bc3d278eb17bf5c"

    strings:
        $s0 = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\%s" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "%s\\temp\\temp%d.bat" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "EventStartShell" fullword ascii /* PEStudio Blacklist: strings */
        $s6 = "del /f /q \"%s\"" fullword ascii
        $s7 = "\\wminotify.dll" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 400KB and all of them
}

rule CN_Honker_CnCerT_CCdoor_CMD_2 {
    meta:
        id = "jZBXY9DrcNqanOJPiAe5O"
        fingerprint = "v1_sha256_8f33f2999eae3f080e8e5ec51ced3e7d596a07b6e5c9830cc1ca552701ed6502"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll2"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7f3a6fb30845bf366e14fa21f7e05d71baa1215a"

    strings:
        $s0 = "cmd.dll" fullword wide
        $s1 = "cmdpath" fullword ascii
        $s2 = "Get4Bytes" fullword ascii
        $s3 = "ExcuteCmd" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 22KB and all of them
}

rule CN_Honker_exp_ms11046 {
    meta:
        id = "rHYa1hLACIRv0jd9h94NX"
        fingerprint = "v1_sha256_0496e5c062c1a248b118c2f6009c95bfddf753e5491529d4ec43cfaf1ea0c0c5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ms11046.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f8414a374011fd239a6c6d9c6ca5851cd8936409"

    strings:
        $s0 = "[*] Token system command" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "[*] command add user 90sec 90sec" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "[*] Add to Administrators success" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Program: %s%s%s%s%s%s%s%s%s%s%s" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 3 times */
    condition:
        uint16(0) == 0x5a4d and filesize < 300KB and all of them
}

rule CN_Honker_Master_beta_1_7 {
    meta:
        id = "30Ro2V85Zeua2K0Ge2BR81"
        fingerprint = "v1_sha256_13c9cc0bf8aaed2ba86baeee6f0b32bf71108dc1350dcffd03e70393fa975c9f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Master_beta_1.7.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3be7a370791f29be89acccf3f2608fd165e8059e"

    strings:
        $s1 = "http://seo.chinaz.com/?host=" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Location: getpass.asp?info=" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 312KB and all of them
}

rule CN_Honker_F4ck_Team_f4ck_2 {
    meta:
        id = "6mPmKivi0TrCO9vqPHmKzG"
        fingerprint = "v1_sha256_85c73d480019929eef5951b0395f49cea86dc83b334860e940cc6e36c2d96d3a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file f4ck_2.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0783661077312753802bd64bf5d35c4666ad0a82"

    strings:
        $s1 = "F4ck.exe" fullword wide
        $s2 = "@Netapi32.dll" fullword ascii
        $s3 = "Team.F4ck.Net" fullword wide
        $s8 = "Administrators" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 14 times */
        $s9 = "F4ck Team" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 220KB and 2 of them
}

rule CN_Honker_sig_3389_80_AntiFW {
    meta:
        id = "3XcWiRPP2Tz8HKDz7AM4a4"
        fingerprint = "v1_sha256_5e940406b713458ae7168d4e140f15a262b7f0834d29db9c88f1f04bedb41e43"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file AntiFW.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5fbc75900e48f83d0e3592ea9fa4b70da72ccaa3"

    strings:
        $s1 = "Set TS to port:80 Successfully!" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Now,set TS to port 80" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "echo. >>amethyst.reg" fullword ascii
        $s4 = "del amethyst.reg" fullword ascii
        $s5 = "AntiFW.cpp" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 30KB and 2 of them
}

rule CN_Honker_wwwscan_gui {
    meta:
        id = "7L2xFRpExKF0wcsyptBjQp"
        fingerprint = "v1_sha256_9c25cf33fc2f675c8db7b24f2abe03d54c0ae17927e0ca9ccd3e5b97ffc56f73"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file wwwscan_gui.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "897b66a34c58621190cb88e9b2a2a90bf9b71a53"

    strings:
        $s1 = "%s www.target.com -p 8080 -m 10 -t 16" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "/eye2007Admin_login.aspx" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 280KB and all of them
}

rule CN_Honker_SwordCollEdition {
    meta:
        id = "7QeWtm1y61bbz4kvajL0KC"
        fingerprint = "v1_sha256_bbc5c9bb91bdd60582e2d7f6fa9b1a1cc3799e0809b670d575d9b2c77bf5e884"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SwordCollEdition.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "6e14f21cac6e2aa7535e45d81e8d1f6913fd6e8b"

    strings:
        $s0 = "YuJianScan.exe" fullword wide /* PEStudio Blacklist: strings */
        $s1 = "YuJianScan" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 225KB and all of them
}

rule CN_Honker_HconSTFportable {
    meta:
        id = "4HSL4Mois56v9SmcBhXkW5"
        fingerprint = "v1_sha256_d4368994d38b87a4c0a53321a468fa8a72411ccb17befa0bbc62bdd6de9e1a52"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file HconSTFportable.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "00253a00eadb3ec21a06911a3d92728bbbe80c09"

    strings:
        $s1 = "HconSTFportable.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "www.Hcon.in" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 354KB and all of them
}

rule CN_Honker_T00ls_Lpk_Sethc_v3_LPK {
    meta:
        id = "2hXm1YnXGLxoW3s0zFPiS9"
        fingerprint = "v1_sha256_02b9f5a8221dab5ea1ba9c728a00c3e69d3866c9a9e9f372affd4f0577fdde0b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file LPK.DAT"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "cf2549bbbbdb7aaf232d9783873667e35c8d96c1"

    strings:
        $s1 = "FreeHostKillexe.exe" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "\\sethc.exe /G everyone:F" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "c:\\1.exe" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Set user Group Error! Username:" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 400KB and all of them
}

rule CN_Honker_Without_a_trace_Wywz {
    meta:
        id = "7Txu3tVLuSVZhtAgyp6njz"
        fingerprint = "v1_sha256_66329b762ed345bc97f9effa38ac9ce0dbf87032321eeb8ed9b56728ed368987"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Wywz.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f443c43fde643228ee95def5c8ed3171f16daad8"

    strings:
        $s1 = "\\Symantec\\Norton Personal Firewall\\Log\\Content.log" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "UpdateFile=d:\\tool\\config.ini,Option\\\\proxyIp=127.0.0.1\\r\\nproxyPort=808" ascii /* PEStudio Blacklist: strings */
        $s3 = "%s\\subinacl.exe /subkeyreg \"%s\" /Grant=%s=f /Grant=everyone=f" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 1800KB and all of them
}

rule CN_Honker_LPK2_0_LPK {
    meta:
        id = "2BkgH3TswCrBNm2edl1CAn"
        fingerprint = "v1_sha256_c112f4ba38a14db968eb20b0ec9237736bc75b169c74896926141ea561100fd4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file LPK.DAT"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5a1226e73daba516c889328f295e728f07fdf1c3"

    strings:
        $s1 = "\\sethc.exe /G everyone:F" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "net1 user guest guest123!@#" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "\\dllcache\\sethc.exe" fullword ascii
        $s4 = "sathc.exe 211" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 1030KB and all of them
}

rule CN_Honker_cleaniis {
    meta:
        id = "7DxcbggOQcpvWbhWs3SK9d"
        fingerprint = "v1_sha256_6f3fe22c9ce8b576116a3fc185910488f37b687c1158d49a93feaa68a144a8db"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file cleaniis.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "372bc64c842f6ff0d9a1aa2a2a44659d8b88cb40"

    strings:
        $s1 = "iisantidote <logfile dir> <ip or string to hide>" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "IIS log file cleaner by Scurt" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker_arp3_7_arp3_7 {
    meta:
        id = "3KNH0e7u7hUmOwnFhls7G6"
        fingerprint = "v1_sha256_9930d5f13c4dc5cae25dece811911e71e858e3fef51a09c99883699e7feb4908"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file arp3.7.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "db641a9dfec103b98548ac7f6ca474715040f25c"

    strings:
        $s1 = "CnCerT.Net.SKiller.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "www.80sec.com" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 4000KB and all of them
}

rule CN_Honker_exp_ms11080 {
    meta:
        id = "NUWCoola9V00BDCuZzpCk"
        fingerprint = "v1_sha256_57eb1cdd1108c82da399b0aa869edc9e377e0185896504716bec8925599c07f0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ms11080.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f0854c49eddf807f3a7381d3b20f9af4a3024e9f"

    strings:
        $s2 = "[*] command add user 90sec 90sec" fullword ascii /* PEStudio Blacklist: strings */
        $s6 = "[*] Add to Administrators success" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 840KB and all of them
}

rule CN_Honker_Injection_transit {
    meta:
        id = "18zUa1fJE6nvTz6Sm75yuK"
        fingerprint = "v1_sha256_3e6fe804b9b6e8555c847a165bb0a8b266004653531fe8f11e3937108757f2ff"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Injection_transit.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f4fef2e3d310494a3c3962a49c7c5a9ea072b2ea"

    strings:
        $s0 = "<description>Your app description here</description> " fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Copyright (C) 2003 ZYDSoft Corp." fullword wide /* PEStudio Blacklist: os */
        $s5 = "ScriptnackgBun" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3175KB and all of them
}

rule CN_Honker_Safe3WVS {
    meta:
        id = "4BP8meHc1GAdNCLB24HoCN"
        fingerprint = "v1_sha256_2b8f6c76e10dad196adeae326d4641ac5271ffa25300234d2f8f6bcabaf5230b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Safe3WVS.EXE"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "fee3acacc763dc55df1373709a666d94c9364a7f"

    strings:
        $s0 = "2TerminateProcess" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "mscoreei.dll" fullword ascii /* reversed goodware string 'lld.ieerocsm' */
        $s7 = "SafeVS.exe" fullword wide
        $s8 = "www.safe3.com.cn" fullword wide
        $s20 = "SOFTWARE\\Classes\\Interface\\" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3000KB and all of them
}

rule CN_Honker_NBSI_3_0 {
    meta:
        id = "10L1Ekni6cPCxAvcOOlISS"
        fingerprint = "v1_sha256_017b5f76a3168089f3186134e7a4c0352158bb866228776240f0d014834e6ee0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file NBSI 3.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "93bf0f64bec926e9aa2caf4c28df9af27ec0e104"

    strings:
        $s1 = ";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet" wide /* PEStudio Blacklist: strings */
        $s2 = "http://localhost/1.asp?id=16" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = " exec master.dbo.xp_cmdshell @Z--" fullword wide /* PEStudio Blacklist: strings */
        $s4 = ";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet" wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 2600KB and 2 of them
}

rule CN_Honker_sig_3389_DUBrute_v3_0_RC3_2_0 {
    meta:
        id = "zEvCOsIbB7d7U1bgIH76h"
        fingerprint = "v1_sha256_8c9be7e8cc04eba6b131acc3c85ac48d7663260a2e4064ad55ed8f40e0875cf4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file 2.0.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e8ee982421ccff96121ffd24a3d84e3079f3750f"

    strings:
        $s0 = "IP - %d; Login - %d; Password - %d; Combination - %d" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Create %d IP@Loginl;Password" fullword ascii /* PEStudio Blacklist: strings */
        $s15 = "UBrute.com" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 980KB and 2 of them
}

rule CN_Honker_hkmjjiis6 {
    meta:
        id = "3J7CbROwEylYyn5ivFRfdT"
        fingerprint = "v1_sha256_a01dcbc8a4ebbfb393e569732a8c4f0848693d2ad0565d04808e81c129e40ba7"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file hkmjjiis6.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4cbc6344c6712fa819683a4bd7b53f78ea4047d7"

    strings:
        $s14 = "* FROM IIsWebInfo/r" fullword ascii
        $s19 = "ltithread4ck/" fullword ascii
        $s20 = "LookupAcc=Sid#" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 175KB and all of them
}

rule CN_Honker_clearlogs {
    meta:
        id = "7BoxtaAbShKeI1kihAnOOa"
        fingerprint = "v1_sha256_65267aa65052406acef67a7f4c6e5d94a3d8a20b93a01046ba83ce7165c92336"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file clearlogs.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "490f3bc318f415685d7e32176088001679b0da1b"

    strings:
        $s2 = "- http://ntsecurity.nu/toolbox/clearlogs/" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Error: Unable to clear log - " fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 140KB and all of them
}

rule CN_Honker_no_net_priv_esc_AddUser {
    meta:
        id = "TwbtwyqAWmfmMj7QnX2bx"
        fingerprint = "v1_sha256_743e67e2aa95830034db1afda1f346c30467c7b59e030ed27415e5127013be74"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file AddUser.dll"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4c95046be6ae40aee69a433e9a47f824598db2d4"

    strings:
        $s0 = "PECompact2" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "adduser" fullword ascii
        $s5 = "OagaBoxA" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 115KB and all of them
}

rule CN_Honker_Injection {
    meta:
        id = "5kPSoy4nmyo1bXC2vxr0sp"
        fingerprint = "v1_sha256_8de3e59bd118fbbf1a012c6bfb358dba7c8fb758e3ac17277f2ad3a92c0284ba"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Injection.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3484ed16e6f9e0d603cbc5cb44e46b8b7e775d35"

    strings:
        $s0 = "http://127.0.0.1/6kbbs/bank.asp" fullword ascii /* PEStudio Blacklist: strings */
        $s7 = "jmPost.asp" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 220KB and all of them
}

rule CN_Honker_SQLServer_inject_Creaked {
    meta:
        id = "5tWOCcfD5WP8K503SIDczC"
        fingerprint = "v1_sha256_2a7e913a4b7bb6c1270d862108eae7ed3998114b672ca7fa19bd0b199fc27dc2"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SQLServer_inject_Creaked.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "af3c41756ec8768483a4cf59b2e639994426e2c2"

    strings:
        $s1 = "http://localhost/index.asp?id=2" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Email:zhaoxypass@yahoo.com.cn<br>" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 8110KB and all of them
}

rule CN_Honker_WebScan_WebScan {
    meta:
        id = "1xKcGyUZzqZkf3Hz8IdH0v"
        fingerprint = "v1_sha256_a714fe90dce33180b8074e2c3a16fc1829ed2a7b387eb92aec8a147cff9e57a4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file WebScan.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a0b0e2422e0e9edb1aed6abb5d2e3d156b7c8204"

    strings:
        $s1 = "wwwscan.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "WWWScan Gui" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 700KB and all of them
}

rule CN_Honker_GetHashes_2 {
    meta:
        id = "6RM6x6YfkfZcbgSy4Zhy89"
        fingerprint = "v1_sha256_778fde2c59d4523142c0ac5b5c953c9eedbbf3c00b406541c00c1aa1f1a9cc58"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file GetHashes.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "35ae9ccba8d607d8c19a065cf553070c54b091d8"

    strings:
        $s1 = "GetHashes.exe <SAM registry file> [System key file]" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "GetHashes.exe $Local" fullword ascii
        $s3 = "The system key doesn't match SAM registry file!" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 300KB and 2 of them
}

rule CN_Honker_Acunetix_Web_Vulnerability_Scanner_8_x_Enterprise_Edition_KeyGen {
    meta:
        id = "4xkKVtS0dKgSdFPNlNSDGb"
        fingerprint = "v1_sha256_daa67ab6a9683668757f7f8cc1728948e0f880eeea56b6a5f43a51c492a60270"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Acunetix_Web_Vulnerability_Scanner_8.x_Enterprise_Edition_KeyGen.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e32f5de730e324fb386f97b6da9ba500cf3a4f8d"

    strings:
        $s0 = "<description>Patch</description>" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "\\dup2patcher.dll" fullword ascii
        $s3 = "load_patcher" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 4000KB and all of them
}

rule CN_Honker_Tuoku_script_oracle_2 {
    meta:
        id = "1PcuyBbxAeHrn3mlM2wnn2"
        fingerprint = "v1_sha256_627d81323266d67a2402367918b4f6e7277367c3eb027af57ac6966f2a49472c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file oracle.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "865dd591b552787eda18ee0ab604509bae18c197"

    strings:
        $s0 = "webshell" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "Silic Group Hacker Army " fullword ascii
    condition:
        filesize < 3KB and all of them
}

rule CN_Honker_net_packet_capt {
    meta:
        id = "2KVqWVLQaFAfeV02U2cfpo"
        fingerprint = "v1_sha256_b158199a27f1260da5f5c1a8e99bb1cc3d19fe2a10577cc5932f097ff39d4ef8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file net_packet_capt.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2d45a2bd9e74cf14c1d93fff90c2b0665f109c52"

    strings:
        $s1 = "(*.sfd)" fullword ascii
        $s2 = "GetLaBA" fullword ascii
        $s3 = "GAIsProcessorFeature" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1 times */
        $s4 = "- Gablto " ascii
        $s5 = "PaneWyedit" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 50KB and all of them
}

rule CN_Honker_CleanIISLog {
    meta:
        id = "4pmguDq2GbRDh5y5Z4vFkO"
        fingerprint = "v1_sha256_35b428d6178196b0dc6ac2ea3f0ee1dfbf6a98ead2356cb2a35d3d6b780538cc"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file CleanIISLog.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "827cd898bfe8aa7e9aaefbe949d26298f9e24094"

    strings:
        $s1 = "Usage: CleanIISLog <LogFile>|<.> <CleanIP>|<.>" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker_HASH_pwhash {
    meta:
        id = "4O386TyqsSNWtWSAeDIxtV"
        fingerprint = "v1_sha256_a77ae11c35dac3cfb1a2970460d4883feed7fbd3e8a860fa7facaad7ddcd1182"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file pwhash.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "689056588f95749f0382d201fac8f58bac393e98"

    strings:
        $s1 = "Example: quarks-pwdump.exe --dump-hash-domain --with-history" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "quarks-pwdump.exe <options> <NTDS file>" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 1000KB and 1 of them
}

rule CN_Honker_cleaner_cl_2 {
    meta:
        id = "2uWeviEgboezcEMn9lGuYC"
        fingerprint = "v1_sha256_865354152f8441009aaad9022f64c3a014c4df0549b648d66959df56893ab98a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file cl.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "523084e8975b16e255b56db9af0f9eecf174a2dd"

    strings:
        $s0 = "cl -eventlog All/Application/System/Security" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "clear iislog error!" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 50KB and all of them
}

rule CN_Honker_SqlMap_Python_Run {
    meta:
        id = "7g9IUBW0vHXQXUW228q8R2"
        fingerprint = "v1_sha256_86d53a06e2f71b7ce7785c4c8ac017a4552b40c16d64474db4e22dbe1afd9e52"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Run.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a51479a1c589f17c77d22f6cf90b97011c33145f"

    strings:
        $s1 = ".\\Run.log" fullword ascii
        $s2 = "[root@Hacker~]# Sqlmap " fullword ascii
        $s3 = "%sSqlmap %s" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 30KB and all of them
}

rule CN_Honker_SAMInside {
    meta:
        id = "3f7hrPReImzS42mOyj9Oum"
        fingerprint = "v1_sha256_8f095a554121e16b63fdd8d47d957665aed7a2a5885813fa78bc4cee3b8923d3"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SAMInside.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "707ba507f9a74d591f4f2e2f165ff9192557d6dd"

    strings:
        $s0 = "www.InsidePro.com" fullword wide
        $s1 = "SAMInside.exe" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 650KB and all of them
}

rule CN_Honker_WebScan_wwwscan {
    meta:
        id = "3F8yig4OpY45UgujdINLTf"
        fingerprint = "v1_sha256_9d2eee1c1783a08a2eae86d4ea77bdb67db8cf0055a24d88ea09411e63018e8c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file wwwscan.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "6dbffa916d0f0be2d34c8415592b9aba690634c7"

    strings:
        $s1 = "%s www.target.com -p 8080 -m 10 -t 16" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "GET /nothisexistpage.html HTTP/1.1" fullword ascii
        $s3 = "<Usage>:  %s <HostName|Ip> [Options]" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 60KB and all of them
}

rule CN_Honker_sig_3389_2_3389 {
    meta:
        id = "3behLenpb7w14TMHPYnDjJ"
        fingerprint = "v1_sha256_1bfcfec56202726a305b3ad6f6b0fb1f82bb1edce177e68909c67da72bf9be62"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file 3389.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "48d1974215e5cb07d1faa57e37afa91482b5a376"

    strings:
        $s1 = "C:\\Documents and Settings\\Administrator\\" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "net user guest /active:yes" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "\\Microsoft Word.exe" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 80KB and all of them
}

rule CN_Honker_PHP_php11 {
    meta:
        id = "1cQzo5lzK9cZM9hNLRqaGx"
        fingerprint = "v1_sha256_d32b0540521a6b1d65c224bdee463813d72846c26f27326a092bdf3b90c3ae7c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file php11.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "dcc8226e7eb20e4d4bef9e263c14460a7ee5e030"

    strings:
        $s1 = "<tr><td><b><?php if (!$win) {echo wordwrap(myshellexec('id'),90,'<br>',1);} else" ascii /* PEStudio Blacklist: strings */
        $s2 = "foreach (glob($_GET['pathtomass'].\"/*.htm\") as $injectj00) {" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "echo '[cPanel Found] '.$login.':'.$pass.\"  Success\\n\";" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 800KB and all of them
}

rule CN_Honker_WebCruiserWVS {
    meta:
        id = "3QOxY6qDNpE6pTfY6QlPrM"
        fingerprint = "v1_sha256_dd37765488f07299048e9b8fc552120e76d628e0adcaf474fce9bfe60774a0c8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file WebCruiserWVS.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "6c90a9ed4c8a141a343dab1b115cc840a7190304"

    strings:
        $s0 = "id:uid:user:username:password:access:account:accounts:admin_id:admin_name:admin_" ascii /* PEStudio Blacklist: strings */
        $s1 = "Created By WebCruiser - Web Vulnerability Scanner http://sec4app.com" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 700KB and all of them
}

rule CN_Honker_Hookmsgina {
    meta:
        id = "1IlnbqeU7zxpSslWipMfJW"
        fingerprint = "v1_sha256_1e268624a5f8df200ef1a03ce167f38feda59836a864e17297473ba223c5895a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Hookmsgina.dll"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f4d9b329b45fbcf6a3b9f29f2633d5d3d76c9f9d"

    strings:
        $s1 = "\\\\.\\pipe\\WinlogonHack" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "%s?host=%s&domain=%s&user=%s&pass=%s&port=%u" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Global\\WinlogonHack_Load%u" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Hookmsgina.dll" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 300KB and all of them
}

rule CN_Honker_sig_3389_xp3389 {
    meta:
        id = "1ZvFbGn4pQDFN245QRjB5S"
        fingerprint = "v1_sha256_7fd7947a802a65dfd63ece3fc6eaf2da8207e99276a9f6b1ff2c937cf4327945"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file xp3389.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "d776eb7596803b5b94098334657667d34b60d880"

    strings:
        $s1 = "echo \"fdenytsconnections\"=dword:00000000 >> c:\\reg.reg" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "echo [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server] >" ascii /* PEStudio Blacklist: strings */
        $s3 = "echo \"Tsenabled\"=dword:00000001 >> c:\\reg.reg" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 20KB and all of them
}

rule CN_Honker_CookiesView {
    meta:
        id = "2ngHTZa1Eg7ts37VqM6oKJ"
        fingerprint = "v1_sha256_9711bb15f08c18ba068325d1cca0ded8e252ded4ceddfb134d1317ad8a19fbe8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file CookiesView.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c54e1f16d79066edfa0f84e920ed1f4873958755"

    strings:
        $s0 = "V1.0  Http://www.darkst.com Code:New4" fullword ascii
        $s1 = "maotpo@126.com" fullword ascii
        $s2 = "www.baidu.com" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 640KB and all of them
}

rule CN_Honker_T00ls_Lpk_Sethc_v4_LPK {
    meta:
        id = "2erQ9pmOdFJXKDZDJY642T"
        fingerprint = "v1_sha256_82918432231fbbb1f0b66ddfcb6642fea974c4a75d086d6149791965fdc3b259"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file LPK.DAT"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2b2ab50753006f62965bba83460e3960ca7e1926"

    strings:
        $s1 = "http://127.0.0.1/1.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "FreeHostKillexe.exe" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "\\sethc.exe /G everyone:F" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "c:\\1.exe" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 300KB and 1 of them
}

rule CN_Honker_ScanHistory {
    meta:
        id = "4bNLzmNRJ1POAjCOfLA11z"
        fingerprint = "v1_sha256_657a25b5103799446fa88abda39d36a05e080c18d41e9dd98199b506f2bfc419"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ScanHistory.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "14c31e238924ba3abc007dc5a3168b64d7b7de8d"

    strings:
        $s1 = "ScanHistory.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = ".\\Report.dat" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "select  * from  Results order by scandate desc" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker_InvasionErasor {
    meta:
        id = "7MrD8QSN6ZQQXZv09Yo8Xb"
        fingerprint = "v1_sha256_d2f742693682e9409284706a3eb63536a576cb162629bf76bfabf2e0210984a3"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file InvasionErasor.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b37ecd9ee6b137a29c9b9d2801473a521b168794"

    strings:
        $s1 = "c:\\windows\\system32\\config\\*.*" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "c:\\winnt\\*.txt" fullword wide /* PEStudio Blacklist: os */
        $s3 = "Command1" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "Win2003" fullword ascii /* PEStudio Blacklist: os */
        $s5 = "Win 2000" fullword ascii /* PEStudio Blacklist: os */
    condition:
        uint16(0) == 0x5a4d and filesize < 60KB and all of them
}

rule CN_Honker_super_Injection1 {
    meta:
        id = "I0RDs4Mbuuus4903IqxOg"
        fingerprint = "v1_sha256_11a3628b7c34a34dc37604430195e24063d3f0dd0889d6d782ce0ee42cafbb02"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file super Injection1.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "8ff2df40c461f6c42b92b86095296187f2b59b14"

    strings:
        $s2 = "Invalid owner=This control requires version 4.70 or greater of COMCTL32.DLL" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)" fullword ascii /* PEStudio Blacklist: agent */
        $s4 = "ScanInject.log" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 2000KB and all of them
}

rule CN_Honker_Pk_Pker {
    meta:
        id = "yO1HWjJPOr9TcTcVYOQsb"
        fingerprint = "v1_sha256_ea29bc82131751f0aaa4f10cc7576a27d243fb7dade03db7ae3dcb029b306505"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Pker.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "631787f27f27c46f79e58e1accfcc9ecfb4d3a2f"

    strings:
        $s1 = "/msadc/..%5c..%5c..%5c..%5cwinnt/system32/cmd.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "msadc/..\\..\\..\\..\\winnt/system32/cmd.exe" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "--Made by VerKey&Only_Guest&Bincker" fullword wide /* PEStudio Blacklist: strings */
        $s4 = ";APPLET;EMBED;FRAMESET;HEAD;NOFRAMES;NOSCRIPT;OBJECT;SCRIPT;STYLE;" fullword wide /* PEStudio Blacklist: strings */
        $s5 = " --Welcome to Www.Pker.In Made by V.K" fullword wide
        $s6 = "Report.dat" fullword wide /* PEStudio Blacklist: strings */
        $s7 = ".\\Report.dat" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 500KB and 5 of them
}

rule CN_Honker_GetPass_GetPass {
    meta:
        id = "2pZM3maCCdNT3HBGDwf0Qx"
        fingerprint = "v1_sha256_90d802da512f5d460eda6d644660711601d361e2402522d085d3225931a3fca3"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file GetPass.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "d18d952b24110b83abd17e042f9deee679de6a1a"

    strings:
        $s1 = "\\only\\Desktop\\" ascii
        $s2 = "To Run As Administuor" ascii /* PEStudio Blacklist: strings */
        $s3 = "Key to EXIT ... & pause > nul" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 300KB and all of them
}

rule CN_Honker_F4ck_Team_f4ck_3 {
    meta:
        id = "7OD9Fys9wHtHpiWj3uU7yP"
        fingerprint = "v1_sha256_85db31c6bca6e5ddd45168a3adbc382d5a9e8128e0b2a6ed5efe1a2fcd42ff3d"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file f4ck.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7e3bf9b26df08cfa10f10e2283c6f21f5a3a0014"

    strings:
        $s1 = "File UserName PassWord [comment] /add" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "No Net.exe Add User" fullword ascii
        $s3 = "BlackMoon RunTime Error:" fullword ascii
        $s4 = "Team.F4ck.Net" fullword wide
        $s5 = "admin 123456789" fullword ascii /* PEStudio Blacklist: strings */
        $s6 = "blackmoon" fullword ascii
        $s7 = "f4ck Team" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 100KB and 4 of them
}

rule CN_Honker_F4ck_Team_F4ck_3 {
    meta:
        id = "4qkYz1vA8578Bc35Rs0ZbR"
        fingerprint = "v1_sha256_870d22be85da127b3ebfd3f8ec547b6ad1cdc8048b56aea494e8d2643bd61d77"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file F4ck_3.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0b3e9381930f02e170e484f12233bbeb556f3731"

    strings:
        $s1 = "F4ck.exe" fullword wide
        $s2 = "@Netapi32.dll" fullword ascii
        $s3 = "Team.F4ck.Net" fullword wide
        $s6 = "NO Net Add User" fullword wide
        $s7 = "DLL ERROR" fullword ascii
        $s11 = "F4ck Team" fullword wide
    condition:
        uint16(0) == 0x5a4d and filesize < 100KB and 3 of them
}

rule CN_Honker_ACCESS_brute {
    meta:
        id = "1tZmEaCCozkFSGoum0RVDW"
        fingerprint = "v1_sha256_5bd0cbb1c2f5863ef1365dc115c736ade05c290cd6fa09a24c2d344314b522cb"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ACCESS_brute.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f552e05facbeb21cb12f23c34bb1881c43e24c34"

    strings:
        $s1 = ".dns166.co" ascii /* PEStudio Blacklist: strings */
        $s2 = "SExecuteA" ascii /* PEStudio Blacklist: strings */
        $s3 = "ality/clsCom" ascii
        $s4 = "NT_SINK_AddRef" ascii
        $s5 = "WINDOWS\\Syswm" ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 20KB and all of them
}

rule CN_Honker_Fpipe_FPipe {
    meta:
        id = "2xOdEkYs5JRh1qYnwroAXH"
        fingerprint = "v1_sha256_bde46f2508dc82f91e39cc7bd88960e836522b068546ce65ebc07db69b3d4493"
        version = "1.0"
        score = 50
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file FPipe.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a2c51c6fa93a3dfa14aaf31fb1c48a3a66a32d11"

    strings:
        $s1 = "Unable to create TCP listen socket. %s%d" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "http://www.foundstone.com" fullword ascii
        $s3 = "%s %s port %d. Address is already in use" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 20KB and all of them
}

rule CN_Honker_Layer_Layer {
    meta:
        id = "6kfZ5fEfgbkfH6SfeLcSPP"
        fingerprint = "v1_sha256_0d88c2e6f0e55757ff9ad8c13f82bf4f11c0b3f353f14765d073a7ba34d6800e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file Layer.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0f4f27e842787cb854bd61f9aca86a63f653eb41"

    strings:
        $s1 = "\\Release\\Layer.pdb" fullword ascii
        $s2 = "Layer.exe" fullword wide
        $s3 = "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0" fullword wide /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 300KB and all of them
}

rule CN_Honker_ms10048_x86 {
    meta:
        id = "2DQWAgngMEv4Y4ajvvZTKf"
        fingerprint = "v1_sha256_2f67b3be31b1d1eb420b40ec291db7271acd692af9f061d5db17415685cf7546"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file ms10048-x86.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e57b453966e4827e2effa4e153f2923e7d058702"

    strings:
        $s1 = "[+] Set to %d exploit half succeeded" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 30KB and all of them
}

rule CN_Honker_HTran2_4 {
    meta:
        id = "2N4ewIl6dz2drhyUiqYMQ8"
        fingerprint = "v1_sha256_dd1332d3dca12513b1f8a1d10148f6fa2eb7cc809ac7cf6f4dcc9090746718b5"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file HTran2.4.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "524f986692f55620013ab5a06bf942382e64d38a"

    strings:
        $s1 = "Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "[+] New connection %s:%d !!" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 180KB and all of them
}

rule CN_Honker_SkinHRootkit_SkinH {
    meta:
        id = "3V0SEb1k47EJakdbBS3a0E"
        fingerprint = "v1_sha256_97314a8c908c714c39ea8962c87709fdc422c3e2998a2b1694950fa127204335"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - file SkinH.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "d593f03ae06e54b653c7850c872c0eed459b301f"

    strings:
        $s0 = "(C)360.cn Inc.All Rights Reserved." fullword wide
        $s1 = "SDVersion.dll" fullword wide
        $s2 = "skinh.dll" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 2000KB and all of them
}

rule CN_Honker__PostgreSQL_mysql_injectV1_1_Creak_Oracle_SQLServer_inject_Creaked {
    meta:
        id = "6KPNtNkxixx87KZEu7KAM4"
        fingerprint = "v1_sha256_ed809a5fb35d36b2a8758e470657bda1a04d80577d5129962cd7d0ab9a80cf8a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files PostgreSQL.exe, mysql_injectV1.1_Creak.exe, Oracle.exe, SQLServer_inject_Creaked.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "1ecfaa91aae579cfccb8b7a8607176c82ec726f4"
        hash1 = "a1f066789f48a76023598c5777752c15f91b76b0"
        hash2 = "0264f4efdba09eaf1e681220ba96de8498ab3580"
        hash3 = "af3c41756ec8768483a4cf59b2e639994426e2c2"

    strings:
        $s1 = "zhaoxypass@yahoo.com.cn" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Mozilla/3.0 (compatible; Indy Library)" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "ProxyParams.ProxyPort" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and all of them
}

rule CN_Honker__mysql_injectV1_1_Creak_DomainBlastingTool_super_Injection1 {
    meta:
        id = "6O5FP1g3jdZpXhlAvJBsGM"
        fingerprint = "v1_sha256_f4fe013a3ce1e420087d9892d5a7250614a32b21649c0cd2de835dfdd570b08c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files mysql_injectV1.1_Creak.exe, DomainBlastingTool.exe, super Injection1.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "a1f066789f48a76023598c5777752c15f91b76b0"
        hash1 = "6fb6b9d8eb15da3ceabb8cc030eb1bf0fe743485"
        hash2 = "8ff2df40c461f6c42b92b86095296187f2b59b14"

    strings:
        $s1 = "Dark Teal" fullword wide
        $s2 = "TRzFrameControllerProperty" fullword ascii
        $s3 = "hkeyLocalMachine" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 3000KB and all of them
}

rule CN_Honker__wwwscan_wwwscan_wwwscan_gui {
    meta:
        id = "7TdLvjujnmCbkXbeRvUmfq"
        fingerprint = "v1_sha256_0fd6ab38dca839605c1b7cd51a4a8d3268551f0725ccee7c7521f13d6f9e7076"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files wwwscan.exe, wwwscan.exe, wwwscan_gui.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "6dbffa916d0f0be2d34c8415592b9aba690634c7"
        hash1 = "6bed45629c5e54986f2d27cbfc53464108911026"
        hash2 = "897b66a34c58621190cb88e9b2a2a90bf9b71a53"

    strings:
        $s1 = "GET /nothisexistpage.html HTTP/1.1" fullword ascii
        $s2 = "<Usage>:  %s <HostName|Ip> [Options]" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule CN_Honker__LPK_LPK_LPK {
    meta:
        id = "3yNECbRWG74Dlm6PDMQ0dq"
        fingerprint = "v1_sha256_786e51b3c3b2e262e3cecc55850fe5fdad0157e240b6bfe88e60b83a714be175"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files LPK.DAT, LPK.DAT, LPK.DAT"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "5a1226e73daba516c889328f295e728f07fdf1c3"
        hash1 = "2b2ab50753006f62965bba83460e3960ca7e1926"
        hash2 = "cf2549bbbbdb7aaf232d9783873667e35c8d96c1"

    strings:
        $s1 = "C:\\WINDOWS\\system32\\cmd.exe" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "Password error!" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "\\sathc.exe" fullword ascii
        $s4 = "\\sothc.exe" fullword ascii
        $s5 = "\\lpksethc.bat" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 1057KB and all of them
}

rule CN_Honker__builder_shift_SkinH {
    meta:
        id = "1lITHhDv5HUOQSnmwJ8A5T"
        fingerprint = "v1_sha256_d15802df98d72b4ef3bac2dfb8ba3338c540ef7290d7ddf9738cf0f7b86e17ea"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files builder.exe, shift.exe, SkinH.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "6b5a84cdc3d27c435d49de3f68872d015a5aadfc"
        hash1 = "ee127c1ea1e3b5bf3d2f8754fabf9d1101ed0ee0"
        hash2 = "d593f03ae06e54b653c7850c872c0eed459b301f"

    strings:
        $s1 = "lipboard" fullword ascii
        $s2 = "uxthem" fullword ascii
        $s3 = "ENIGMA" fullword ascii
        $s4 = "UtilW0ndow" fullword ascii
        $s5 = "prog3am" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 6075KB and all of them
}

rule CN_Honker__lcx_HTran2_4_htran20 {
    meta:
        id = "1KwviyyqhCOA3LE5zlDXjI"
        fingerprint = "v1_sha256_30184394ad3ec7bf209bb0a22da889699bac6167ecc09e693c88f8643c754394"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files lcx.exe, HTran2.4.exe, htran20.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "0c8779849d53d0772bbaa1cedeca150c543ebf38"
        hash1 = "524f986692f55620013ab5a06bf942382e64d38a"
        hash2 = "b992bf5b04d362ed3757e90e57bc5d6b2a04e65c"

    strings:
        $s1 = "[SERVER]connection to %s:%d error" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "[+] OK! I Closed The Two Socket." fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "[+] Start Transmit (%s:%d <-> %s:%d) ......" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x5a4d and filesize < 440KB and all of them
}

rule CN_Honker__D_injection_V2_32_D_injection_V2_32_D_injection_V2_32 {
    meta:
        id = "3bMdCrBXOHLyfCDnSTCLQq"
        fingerprint = "v1_sha256_5c318c670b3aedf66da1c6444df7d630d2263e88527facfcf75d76dd974e7d31"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Sample from CN Honker Pentest Toolset - from files D_injection_V2.32.exe, D_injection_V2.32.exe, D_injection_V2.32.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "3a000b976c79585f62f40f7999ef9bdd326a9513"
        hash1 = "3a000b976c79585f62f40f7999ef9bdd326a9513"
        hash2 = "3a000b976c79585f62f40f7999ef9bdd326a9513"

    strings:
        $s1 = "upfile.asp " fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "[wscript.shell]" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "XP_CMDSHELL" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "[XP_CMDSHELL]" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "http://d99net.3322.org" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 10000KB and 4 of them
}
