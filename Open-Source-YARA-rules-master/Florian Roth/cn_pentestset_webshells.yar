/*
    Yara Rule Set
    Author: Florian Roth
    Date: 2015-06-23
    Identifier: CN-PentestSet
*/

rule CN_Honker_Webshell_PHP_php5 {
    meta:
        id = "7SDmcZtaIbQxJGvIAB1WGP"
        fingerprint = "v1_sha256_e882f115a67fe31ece1a81e1a2770b46370a92ac3aa23e348a12cdb5735e8a0e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php5.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0fd91b6ad400a857a6a65c8132c39e6a16712f19"

    strings:
        $s0 = "else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user" ascii /* PEStudio Blacklist: strings */
        $s20 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$" ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x3f3c and filesize < 300KB and all of them
}

rule CN_Honker_Webshell_test3693 {
    meta:
        id = "7N6MGFUOUTAEL3GP0nzGku"
        fingerprint = "v1_sha256_a10618d54fb7adbbd89a10f2e1ac067ccd1832140bcaf3b92394ebe7323f2d1e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file test3693.war"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "246d629ae3ad980b5bfe7e941fe90b855155dbfc"

    strings:
        $s0 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - " ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x4b50 and filesize < 50KB and all of them
}

rule CN_Honker_Webshell_mycode12 {
    meta:
        id = "1J1jHZJ5zY3tJOqx22gqjB"
        fingerprint = "v1_sha256_94cb0e414634af753db9ec0c63a3a34b4f9104e93e01d67cebab7b3a0c471198"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file mycode12.cfm"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "64be8760be5ab5c2dcf829e3f87d3e50b1922f17"

    strings:
        $s1 = "<cfexecute name=\"cmd.exe\"" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "<cfoutput>#cmd#</cfoutput>" fullword ascii
    condition:
        filesize < 4KB and all of them
}

rule CN_Honker_Webshell_offlibrary {
    meta:
        id = "1Z8KATERMxcpSeACSuDwyU"
        fingerprint = "v1_sha256_ffec24bedfe0794e8f92da5067c41932339e61ec23d71a67ed4b634434cd10d6"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file offlibrary.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "eb5275f99211106ae10a23b7e565d208a94c402b"

    strings:
        $s0 = "';$i=$g->query(\"SELECT SUBSTRING_INDEX(CURRENT_USER, '@', 1) AS User, SUBSTRING" ascii /* PEStudio Blacklist: strings */
        $s12 = "if(jushRoot){var script=document.createElement('script');script.src=jushRoot+'ju" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 1005KB and all of them
}

rule CN_Honker_Webshell_cfm_xl {
    meta:
        id = "58pqzieC61OH8fmgYvq9Wn"
        fingerprint = "v1_sha256_b6683a24ad58a9444ec91f13e7da5db3e3e768afded09a23e1bbd0a0c23cf6b9"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file xl.cfm"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "49c3d16ee970945367a7d6ae86b7ade7cb3b5447"

    strings:
        $s0 = "<input name=\"DESTINATION\" value=\"" ascii /* PEStudio Blacklist: strings */
        $s1 = "<CFFILE ACTION=\"Write\" FILE=\"#Form.path#\" OUTPUT=\"#Form.cmd#\">" fullword ascii
    condition:
        uint16(0) == 0x433c and filesize < 13KB and all of them
}

rule CN_Honker_Webshell_PHP_linux {
    meta:
        id = "7VYf460nIRFratJ3XQeAji"
        fingerprint = "v1_sha256_2c6278acd123e0d41ed4f0f8f0da27d5de1ad56efb8102c9eae442838a0416d0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file linux.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "78339abb4e2bb00fe8a012a0a5b7ffce305f4e06"

    strings:
        $s0 = "<form name=form1 action=exploit.php method=post>" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "<title>Changing CHMOD Permissions Exploit " fullword ascii
    condition:
        uint16(0) == 0x696c and filesize < 6KB and all of them
}

rule CN_Honker_Webshell_Interception3389_get {
    meta:
        id = "3T9YwN3iP91IkA0bDcRYiB"
        fingerprint = "v1_sha256_649e611c9d8948e60811af4209d737b3e797e6b42beba42439541ae543b062d6"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file get.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ceb6306f6379c2c1634b5058e1894b43abcf0296"

    strings:
        $s0 = "userip = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "file.writeline  szTime + \" HostName:\" + szhostname + \" IP:\" + userip+\":\"+n" ascii /* PEStudio Blacklist: strings */
        $s3 = "set file=fs.OpenTextFile(server.MapPath(\"WinlogonHack.txt\"),8,True)" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 3KB and all of them
}

rule CN_Honker_Webshell_nc_1 {
    meta:
        id = "7MWlpQhS3YgwshX2aneZ9c"
        fingerprint = "v1_sha256_80ea8f16d943a3775fe9999131272af9e7f1af60d413109e58ecdef036484760"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file 1.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "51d83961171db000fe4476f36d703ef3de409676"

    strings:
        $s1 = "User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 " ascii /* PEStudio Blacklist: agent */
        $s2 = "<%if session(\"pw\")<>\"go\" then %>" fullword ascii
    condition:
        filesize < 11KB and all of them
}

rule CN_Honker_Webshell_PHP_BlackSky {
    meta:
        id = "6no5TPDKBKnM73s44IEs6S"
        fingerprint = "v1_sha256_3b92f63f536361d8ba0cde853fb546f271abdec3a7c1d44688a42610f5f90c57"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php6.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "a60a599c6c8b6a6c0d9da93201d116af257636d7"

    strings:
        $s0 = "eval(gzinflate(base64_decode('" ascii /* PEStudio Blacklist: strings */
        $s1 = "B1ac7Sky-->" fullword ascii
    condition:
        filesize < 641KB and all of them
}

rule CN_Honker_Webshell_ASP_asp3 {
    meta:
        id = "iZFE69H9bJHKtZekz4oLg"
        fingerprint = "v1_sha256_e5f30a445be30c491e669c633bf2df08cbfb1017ecfc91f9ed83275550488304"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file asp3.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "87c5a76989bf08da5562e0b75c196dcb3087a27b"

    strings:
        $s1 = "if shellpath=\"\" then shellpath = \"cmd.exe\"" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/M_Schumacher/upadmin/s3\", Tru" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 444KB and all of them
}

rule CN_Honker_Webshell_ASPX_sniff {
    meta:
        id = "1rrQa7G2ZhSuGPSTU3JWn5"
        fingerprint = "v1_sha256_198442e75422055e7d65c5d1aef55819036a99077aa79dbd5006ba97c4fe4af8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file sniff.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e246256696be90189e6d50a4ebc880e6d9e28dfd"

    strings:
        $s1 = "IPHostEntry HosyEntry = Dns.GetHostEntry((Dns.GetHostName()));" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "if (!logIt && my_s_smtp && (dport == 25 || sport == 25))" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 91KB and all of them
}

rule CN_Honker_Webshell_udf_udf {
    meta:
        id = "5vKgJqu47Ty2Liph4doF1N"
        fingerprint = "v1_sha256_c7db32b5e66601e0b8322ac67b6b9ba8d6222891ed01db557bfac9985140421a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file udf.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "df63372ccab190f2f1d852f709f6b97a8d9d22b9"

    strings:
        $s1 = "<?php // Source  My : Meiam  " fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "$OOO0O0O00=__FILE__;$OOO000000=urldecode('" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 430KB and all of them
}

rule CN_Honker_Webshell_JSP_jsp {
    meta:
        id = "2if68g5euvPzvWxGWxTwxh"
        fingerprint = "v1_sha256_089e1a553900d149a4087ac81254295d74de15d9baaf73e60ce4f061e450e8c7"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file jsp.html"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c58fed3d3d1e82e5591509b04ed09cb3675dc33a"

    strings:
        $s1 = "<input name=f size=30 value=shell.jsp>" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "<font color=red>www.i0day.com  By:" fullword ascii
    condition:
        filesize < 3KB and all of them
}

rule CN_Honker_Webshell_T00ls_Lpk_Sethc_v4_mail {
    meta:
        id = "5m1B8osruITRZOhjkor4K5"
        fingerprint = "v1_sha256_b835a6d0c736116e0a8b277dadbf25c2ac333b0d7937a6f67ed59887c610a57a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file mail.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "0a9b7b438591ee78ee573028cbb805a9dbb9da96"

    strings:
        $s1 = "if (!$this->smtp_putcmd(\"AUTH LOGIN\", base64_encode($this->user)))" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "$this->smtp_debug(\"> \".$cmd.\"\\n\");" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 39KB and all of them
}

rule CN_Honker_Webshell_phpwebbackup {
    meta:
        id = "4QIPvr8ypouGF7OayDPNbo"
        fingerprint = "v1_sha256_45452fc415fbafe170a1b1f5a58df40f0ec65a9a6678e675b40a8c54e2d8bd6c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file phpwebbackup.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c788cb280b7ad0429313837082fe84e9a49efab6"

    strings:
        $s0 = "<?php // Code By isosky www.nbst.org" fullword ascii
        $s2 = "$OOO0O0O00=__FILE__;$OOO000000=urldecode('" ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x3f3c and filesize < 67KB and all of them
}

rule CN_Honker_Webshell_dz_phpcms_phpbb {
    meta:
        id = "3j6JVib6hRkMnRaoIcjlQA"
        fingerprint = "v1_sha256_1455df58f51c3ae7558b89c940d97ea5870f261217b2a09727bb6678bcbd5500"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file dz_phpcms_phpbb.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "33f23c41df452f8ca2768545ac6e740f30c44d1f"

    strings:
        $s1 = "if($pwd == md5(md5($password).$salt))" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "function test_1($password)" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = ":\".$pwd.\"\\n---------------------------------\\n\";exit;" fullword ascii
        $s4 = ":user=\".$user.\"\\n\";echo \"pwd=\".$pwd.\"\\n\";echo \"salt=\".$salt.\"\\n\";" fullword ascii
    condition:
        filesize < 22KB and all of them
}

rule CN_Honker_Webshell_picloaked_1 {
    meta:
        id = "7khiEVZsrB0ESOjfCxDwOP"
        fingerprint = "v1_sha256_a816ac9e98b7c5208f075ffcb9a6525016d6a5c468005d78ecab90d651423705"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file 1.gif"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3eab1798cbc9ab3b2c67d3da7b418d07e775db70"

    strings:
        $s0 = "<?php eval($_POST[" ascii /* PEStudio Blacklist: strings */
        $s1 = ";<%execute(request(" ascii /* PEStudio Blacklist: strings */
        $s3 = "GIF89a" fullword ascii /* Goodware String - occured 318 times */
    condition:
        filesize < 6KB and 2 of them
}

rule CN_Honker_Webshell_assembly {
    meta:
        id = "6AGGpel0rod5YgAERPjpqN"
        fingerprint = "v1_sha256_34dc47b2f91a15a62175f3cab88d5ff24d2a3aa62f74fb9e43a4aaae96ced999"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file assembly.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2bcb4d22758b20df6b9135d3fb3c8f35a9d9028e"

    strings:
        $s0 = "response.write oScriptlhn.exec(\"cmd.exe /c\" & request(\"c\")).stdout.readall" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_Webshell_PHP_php8 {
    meta:
        id = "5icNAscuFpDnSrU542oVHY"
        fingerprint = "v1_sha256_435ceb72c082f702284c464979a907a59a42bb4aa07311f9b2da1a9831efac11"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php8.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b7b49f1d6645865691eccd025e140c521ff01cce"

    strings:
        $s0 = "<a href=\"http://hi.baidu.com/ca3tie1/home\" target=\"_blank\">Ca3tie1's Blog</a" ascii /* PEStudio Blacklist: strings */
        $s1 = "function startfile($path = 'dodo.zip')" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "<form name=\"myform\" method=\"post\" action=\"\">" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "$_REQUEST[zipname] = \"dodozip.zip\"; " fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 25KB and 2 of them
}

rule CN_Honker_Webshell_Tuoku_script_xx {
    meta:
        id = "ucvgNlkGGd3D0BA29A6M1"
        fingerprint = "v1_sha256_67c542f172fd1b97fbee4697fd42bab9486e3d779ce62993617e5a5205bd75d4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file xx.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2f39f1d9846ae72fc673f9166536dc21d8f396aa"

    strings:
        $s0 = "$mysql.=\"insert into `$table`($keys) values($vals);\\r\\n\";" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "$mysql_link=@mysql_connect($mysql_servername , $mysql_username , $mysql_password" ascii /* PEStudio Blacklist: strings */
        $s16 = "mysql_query(\"SET NAMES gbk\");" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 2KB and all of them
}

rule CN_Honker_Webshell_JSPMSSQL {
    meta:
        id = "5JnZVURGqqbOMAMtmrWbBp"
        fingerprint = "v1_sha256_c08e69345cb09e41840a81dcd8a015f9e1be93d570b64c310be74631e5314e2f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file JSPMSSQL.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c6b4faecd743d151fe0a4634e37c9a5f6533655f"

    strings:
        $s1 = "<form action=\"?action=operator&cmd=execute\"" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "String sql = request.getParameter(\"sqlcmd\");" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 35KB and all of them
}

rule CN_Honker_Webshell_Injection_Transit_jmPost {
    meta:
        id = "403dcXHY3JeV1Tq4c0NRXG"
        fingerprint = "v1_sha256_6c7f52cf7ff6df9867ea2c46cd8f40ef0e077d4e1d9033cde0649a209bffe21b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file jmPost.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f80ec26bbdc803786925e8e0450ad7146b2478ff"

    strings:
        $s1 = "response.write  PostData(JMUrl,JmStr,JmCok,JmRef)" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "JmdcwName=request(\"jmdcw\")" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 9KB and all of them
}

rule CN_Honker_Webshell_ASP_web_asp {
    meta:
        id = "6eUicDayG6sg98qedgP6xM"
        fingerprint = "v1_sha256_5d2d7e6b9340ee4fd845ff05c99526c919214974b1a0def66492fe3cd4a75fe9"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file web.asp.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "aebf6530e89af2ad332062c6aae4a8ca91517c76"

    strings:
        $s0 = "<FORM method=post target=_blank>ShellUrl: <INPUT " fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "\" >[Copy code]</a> 4ngr7&nbsp; &nbsp;</td>" fullword ascii
    condition:
        filesize < 13KB and all of them
}

rule CN_Honker_Webshell_wshell_asp {
    meta:
        id = "1agcqz4oKLJXnHuH3atGwr"
        fingerprint = "v1_sha256_f3c4af85e4798d3a809d8edd9cc46d1df44453f14ed050b002fe789da4d6096f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file wshell-asp.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4a0afdf5a45a759c14e99eb5315964368ca53e9c"

    strings:
        $s1 = "file1.Write(\"<%response.clear:execute request(\\\"root\\\"):response.End%>\");" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "hello word !  " fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "root.asp " fullword ascii
    condition:
        filesize < 5KB and all of them
}

rule CN_Honker_Webshell_ASP_asp404 {
    meta:
        id = "5OcggywbgvwAT6BmkeAgo6"
        fingerprint = "v1_sha256_c84be2e561a08317be11cdb0fe103f8ad182a64d8cd1bf987163ebbeabe20f00"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file asp404.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "bed51971288aeabba6dabbfb80d2843ec0c4ebf6"

    strings:
        $s0 = "temp1 = Len(folderspec) - Len(server.MapPath(\"./\")) -1" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "<form name=\"form1\" method=\"post\" action=\"<%= url%>?action=chklogin\">" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "<td>&nbsp;<a href=\"<%=tempurl+f1.name%>\" target=\"_blank\"><%=f1.name%></a></t" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 113KB and all of them
}

rule CN_Honker_Webshell_Serv_U_asp {
    meta:
        id = "7T45rFhR37P6Fd8ES845rT"
        fingerprint = "v1_sha256_c98c3f4db5ea812827b6108ef88b57116621142202248f4f26f0c71bd76e33ec"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file Serv-U asp.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "cee91cd462a459d31a95ac08fe80c70d2f9c1611"

    strings:
        $s1 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" &" ascii /* PEStudio Blacklist: strings */
        $s2 = "<td><input name=\"c\" type=\"text\" id=\"c\" value=\"cmd /c net user goldsun lov" ascii /* PEStudio Blacklist: strings */
        $s3 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \" PortNo=\"" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 30KB and 2 of them
}

rule CN_Honker_Webshell_cfm_list {
    meta:
        id = "5v0ANzD7JgfKwXvlPgeT5u"
        fingerprint = "v1_sha256_41c7c5ba6187a8871dec83bcd859b9377813d60cea8ef2b4ad390c67de04e010"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file list.cfm"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "85d445b13d2aef1df3b264c9b66d73f0ff345cec"

    strings:
        $s1 = "<TD><a href=\"javascript:ShowFile('#mydirectory.name#')\">#mydirectory.name#</a>" ascii /* PEStudio Blacklist: strings */
        $s2 = "<TD>#mydirectory.size#</TD>" fullword ascii
    condition:
        filesize < 10KB and all of them
}

rule CN_Honker_Webshell_PHP_php2 {
    meta:
        id = "3n6FnN2PkWFa3hVC4nTslg"
        fingerprint = "v1_sha256_707e2795d82636fbbc4d9f5324e509a526f77f9ead8f3c4d59dd0e95bc94f11e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php2.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "bf12e1d741075cd1bd324a143ec26c732a241dea"

    strings:
        $s1 = "$OOO0O0O00=__FILE__;$OOO000000=urldecode('" ascii /* PEStudio Blacklist: strings */
        $s2 = "<?php // Black" fullword ascii
    condition:
        filesize < 12KB and all of them
}

rule CN_Honker_Webshell_Tuoku_script_oracle {
    meta:
        id = "NCbWyXrFhjkrUTsu5bkuc"
        fingerprint = "v1_sha256_3ad4207e426ed2f9df0e0bac0e906af437b0774ba2ebb541afbe7e29b395ad63"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file oracle.jsp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "fc7043aaac0ee2d860d11f18ddfffbede9d07957"

    strings:
        $s1 = "String url=\"jdbc:oracle:thin:@localhost:1521:orcl\";" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "String user=\"oracle_admin\";" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "String sql=\"SELECT 1,2,3,4,5,6,7,8,9,10 from user_info\";" fullword ascii
    condition:
        filesize < 7KB and all of them
}

rule CN_Honker_Webshell_ASPX_aspx4 {
    meta:
        id = "7hqrCjpCcBKcUUYSLnMsgg"
        fingerprint = "v1_sha256_0aab8e327b4477cb0b8cd5d4b1e4b52c160180656dad57b0498654da1c8d7a29"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file aspx4.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "200a8f15ffb6e3af31d28c55588003b5025497eb"

    strings:
        $s4 = "File.Delete(cdir.FullName + \"\\\\test\");" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "start<asp:TextBox ID=\"Fport_TextBox\" runat=\"server\" Text=\"c:\\\" Width=\"60" ascii /* PEStudio Blacklist: strings */
        $s6 = "<div>Code By <a href =\"http://www.hkmjj.com\">Www.hkmjj.Com</a></div>" fullword ascii
    condition:
        filesize < 11KB and all of them
}

rule CN_Honker_Webshell_ASPX_aspx {
    meta:
        id = "7OBwR30rEgl5Xu8Hyjf5Gd"
        fingerprint = "v1_sha256_b59684633fd72bd1804a96850a8b358db98c169415b6e65fe3ecfb4d9fde72d0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file aspx.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "8378619b2a7d446477946eabaa1e6744dec651c1"

    strings:
        $s0 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin" ascii /* PEStudio Blacklist: strings */
        $s1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" O" ascii /* PEStudio Blacklist: strings */
        $s2 = "td.Text=\"<a href=\\\"javascript:Bin_PostBack('urJG','\"+dt.Rows[j][\"ProcessID" ascii /* PEStudio Blacklist: strings */
        $s3 = "vyX.Text+=\"<a href=\\\"javascript:Bin_PostBack('Bin_Regread','\"+MVVJ(rootkey)+" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 353KB and 2 of them
}

rule CN_Honker_Webshell_su7_x_9_x {
    meta:
        id = "7VbtTbAj0O34t9Z2rBtPkF"
        fingerprint = "v1_sha256_2d2398cf0f9e253eea343d39b6555f2633f92f627f1c93cc28123d5a7f3d1bf1"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file su7.x-9.x.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "808396b51023cc8356f8049cfe279b349ca08f1a"

    strings:
        $s0 = "returns=httpopen(\"LoginID=\"&user&\"&FullName=&Password=\"&pass&\"&ComboPasswor" ascii /* PEStudio Blacklist: strings */
        $s1 = "returns=httpopen(\"\",\"POST\",\"http://127.0.0.1:\"&port&\"/Admin/XML/User.xml?" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 59KB and all of them
}

rule CN_Honker_Webshell_cfmShell {
    meta:
        id = "53adQKrAVZHkNlBot5EpVg"
        fingerprint = "v1_sha256_0767012ec8fd4a18a64eca04d459efb55fafd29ed052dab8a0eb1b8f4ce7aa66"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file cfmShell.cfm"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "740796909b5d011128b6c54954788d14faea9117"

    strings:
        $s0 = "<cfexecute name=\"C:\\Winnt\\System32\\cmd.exe\"" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "<cfif FileExists(\"#GetTempDirectory()#foobar.txt\") is \"Yes\">" fullword ascii
    condition:
        filesize < 4KB and all of them
}

rule CN_Honker_Webshell_ASP_asp4 {
    meta:
        id = "5hAvZHSk35aRY02Cp9Q9fX"
        fingerprint = "v1_sha256_ae02d1efc975a8592a00cbab823355fb778fbb589f5752dd913aa432b316c3a4"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file asp4.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4005b83ced1c032dc657283341617c410bc007b8"

    strings:
        $s2 = "if ShellPath=\"\" Then ShellPath = \"cmd.exe\"" fullword ascii /* PEStudio Blacklist: strings */
        $s6 = "Response.Cookies(Cookie_Login) = sPwd" fullword ascii /* PEStudio Blacklist: strings */
        $s8 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 150KB and all of them
}

rule CN_Honker_Webshell_Serv_U_2_admin_by_lake2 {
    meta:
        id = "M3TbXLrOUuQVL7TaRleQ3"
        fingerprint = "v1_sha256_a67c08b3a4bed2385d2fa8c007615bfb37a2d739cc13ee2e0f5eda00536b6ea8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file Serv-U 2 admin by lake2.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "cb8039f213e611ab2687edd23e63956c55f30578"

    strings:
        $s1 = "xPost3.Open \"POST\", \"http://127.0.0.1:\"& port &\"/lake2\", True" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "response.write \"FTP user lake  pass admin123 :)<br><BR>\"" fullword ascii /* PEStudio Blacklist: strings */
        $s8 = "<p>Serv-U Local Get SYSTEM Shell with ASP" fullword ascii /* PEStudio Blacklist: strings */
        $s9 = "\"-HomeDir=c:\\\\\" & vbcrlf & \"-LoginMesFile=\" & vbcrlf & \"-Disable=0\" & vb" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 17KB and 2 of them
}

rule CN_Honker_Webshell_PHP_php3 {
    meta:
        id = "4ZrwCBjM0WixtKS8gz1pgY"
        fingerprint = "v1_sha256_ba3892feacbbe3d7c6b6308a22ca22b19ae84b6490df2c976852260da2a96ca1"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php3.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e2924cb0537f4cdfd6f1bd44caaaf68a73419b9d"

    strings:
        $s1 = "} elseif(@is_resource($f = @popen($cfe,\"r\"))) {" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "cf('/tmp/.bc',$back_connect);" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 8KB and all of them
}

rule CN_Honker_Webshell_Serv_U_by_Goldsun {
    meta:
        id = "4CknC5hVVlF6deg2slPSUW"
        fingerprint = "v1_sha256_962b2e75c03f716fc039cf26aa238e9a3faf5a7ea8fb3d4da556fa601790055a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file Serv-U_by_Goldsun.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "d4d7a632af65a961a1dbd0cff80d5a5c2b397e8c"

    strings:
        $s1 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/goldsun/upadmin/s2\", True," ascii /* PEStudio Blacklist: strings */
        $s2 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" &" ascii /* PEStudio Blacklist: strings */
        $s3 = "127.0.0.1:<%=port%>," fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "GName=\"http://\" & request.servervariables(\"server_name\")&\":\"&request.serve" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 30KB and 2 of them
}

rule CN_Honker_Webshell_PHP_php10 {
    meta:
        id = "2IGgFWVfdUxy7Gyb5LRlbg"
        fingerprint = "v1_sha256_76bb2dfd518173f031cc3c93b2098edaef4aca09f0dd8228223257b0b7df452b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php10.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3698c566a0ae07234c8957112cdb34b79362b494"

    strings:
        $s1 = "dumpTable($N,$M,$Hc=false){if($_POST[\"format\"]!=\"sql\"){echo\"\\xef\\xbb\\xbf" ascii /* PEStudio Blacklist: strings */
        $s2 = "';if(DB==\"\"||!$od){echo\"<a href='\".h(ME).\"sql='\".bold(isset($_GET[\"sql\"]" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 600KB and all of them
}
rule CN_Honker_Webshell_Serv_U_servu {
    meta:
        id = "1yoPZ3V0gZGjr5MKFKmQo9"
        fingerprint = "v1_sha256_d3956b6daa0649233372aea4176e0d43c44d866146884222f92b7efe01f288bb"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file servu.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7de701b86820096e486e64ca34f1fa9f2fbba641"

    strings:
        $s0 = "fputs ($conn_id, \"SITE EXEC \".$dir.\"cmd.exe /c \".$cmd.\"\\r\\n\");" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "function ftpcmd($ftpport,$user,$password,$dir,$cmd){" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 41KB and all of them
}

rule CN_Honker_Webshell_portRecall_jsp2 {
    meta:
        id = "63HI9ZU2fKs1xfb3YLdpDQ"
        fingerprint = "v1_sha256_1ec77a1b0d30cdebce1b5b07445247016230b733a594d8d1de642c2c8af63031"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file jsp2.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "412ed15eb0d24298ba41731502018800ffc24bfc"

    strings:
        $s0 = "final String remoteIP =request.getParameter(\"remoteIP\");" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "final String localIP = request.getParameter(\"localIP\");" fullword ascii /* PEStudio Blacklist: strings */
        $s20 = "final String localPort = \"3390\";//request.getParameter(\"localPort\");" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 23KB and all of them
}

rule CN_Honker_Webshell_ASPX_aspx2 {
    meta:
        id = "xlOnMZMxOFARElHogiW4o"
        fingerprint = "v1_sha256_7af90992bc3f708d877dcd5841c0d132793e41a0796607907084516d955b3ae0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file aspx2.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "95db7a60f4a9245ffd04c4d9724c2745da55e9fd"

    strings:
        $s0 = "if (password.Equals(this.txtPass.Text))" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "<head runat=\"server\">" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = ":<asp:TextBox runat=\"server\" ID=\"txtPass\" Width=\"400px\"></asp:TextBox>" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "this.lblthispath.Text = Server.MapPath(Request.ServerVariables[\"PATH_INFO\"]);" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x253c and filesize < 9KB and all of them
}

rule CN_Honker_Webshell_ASP_hy2006a {
    meta:
        id = "121S1u0XPgxwNb1VOmpX6Y"
        fingerprint = "v1_sha256_a24bf11a2728bb8d18ea005b057648770956694e0b257d4464ad15ee3e24eda2"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file hy2006a.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "20da92b2075e6d96636f883dcdd3db4a38c01090"

    strings:
        $s15 = "Const myCmdDotExeFile = \"command.com\"" fullword ascii /* PEStudio Blacklist: strings */
        $s16 = "If LCase(appName) = \"cmd.exe\" And appArgs <> \"\" Then" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 406KB and all of them
}

rule CN_Honker_Webshell_PHP_php1 {
    meta:
        id = "5Oy9NfTUnS5NgkmclAiiI3"
        fingerprint = "v1_sha256_aadf47ac6231b41e720efdd85c481ebac8fccb572e57b86b27a95dd367c0d81b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php1.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "c2f4b150f53c78777928921b3a985ec678bfae32"

    strings:
        $s7 = "$sendbuf = \"site exec \".$_POST[\"SUCommand\"].\"\\r\\n\";" fullword ascii /* PEStudio Blacklist: strings */
        $s8 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_c" ascii /* PEStudio Blacklist: strings */
        $s18 = "echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 621KB and all of them
}

rule CN_Honker_Webshell_jspshell2 {
    meta:
        id = "6ktIDv2fvKqptJIhGdp1TU"
        fingerprint = "v1_sha256_3a60991fa557655fbd2450739976ac612a0ea2a3df22873382b05438cac12762"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file jspshell2.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "cc7bc1460416663012fc93d52e2078c0a277ff79"

    strings:
        $s10 = "if (cmd == null) cmd = \"cmd.exe /c set\";" fullword ascii /* PEStudio Blacklist: strings */
        $s11 = "if (program == null) program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 424KB and all of them
}

rule CN_Honker_Webshell_Tuoku_script_mysql {
    meta:
        id = "5VrznfFXNhUc2ovIxefQlC"
        fingerprint = "v1_sha256_bde2ea1ccfc88138456a1b255a32a7323f5ef0f677499db6dc6670987cc37585"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file mysql.aspx"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "8e242c40aabba48687cfb135b51848af4f2d389d"

    strings:
        $s1 = "txtpassword.Attributes.Add(\"onkeydown\", \"SubmitKeyClick('btnLogin');\");" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "connString = string.Format(\"Host = {0}; UserName = {1}; Password = {2}; Databas" ascii /* PEStudio Blacklist: strings */condition:
        filesize < 202KB and all of them
}

rule CN_Honker_Webshell_PHP_php9 {
    meta:
        id = "dUj4fburh7pis6UPaNZEY"
        fingerprint = "v1_sha256_bea117862ebc9220a4d9aee091c808274f9907fceb83b528055998ddcc90aa5f"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php9.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "cd3962b1dba9f1b389212e38857568b69ca76725"

    strings:
        $s1 = "Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r ab" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 1087KB and all of them
}

rule CN_Honker_Webshell_portRecall_jsp {
    meta:
        id = "74TUyEI2MrJ6h6sc0pFVqm"
        fingerprint = "v1_sha256_98f279c3e50308f67f88ecf8459943187ea152664fe0206c4a7d3435242df2a6"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file jsp.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "65e8e4d13ad257c820cad12eef853c6d0134fce8"

    strings:
        $s0 = "lcx.jsp?localIP=202.91.246.59&localPort=88&remoteIP=218.232.111.187&remotePort=2" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_Webshell_ASPX_aspx3 {
    meta:
        id = "4qUU8ysTo2K4aesZbhojA6"
        fingerprint = "v1_sha256_11bf511ee70ff4bde0a9320cb80dd9efa0f437d432c78a859153cfcc8e80db01"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file aspx3.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "dd61481771f67d9593214e605e63b62d5400c72f"

    strings:
        $s0 = "Process p1 = Process.Start(\"\\\"\" + txtRarPath.Value + \"\\\"\", \" a -y -k -m" ascii /* PEStudio Blacklist: strings */
        $s12 = "if (_Debug) System.Console.WriteLine(\"\\ninserting filename into CDS:" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 100KB and all of them
}

rule CN_Honker_Webshell_ASPX_shell_shell {
    meta:
        id = "7aCqKLr0DS12auN9FHMMKq"
        fingerprint = "v1_sha256_ac22d89353b4316289bf6c6e13332ac401f4b57f6c29b71861cb48359c1e55f9"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file shell.aspx"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "1816006827d16ed73cefdd2f11bd4c47c8af43e4"

    strings:
        $s0 = "<%try{ System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cook" ascii /* PEStudio Blacklist: strings */
        $s1 = "<%@ Page Language=\"C#\" ValidateRequest=\"false\" %>" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_Webshell__php1_php7_php9 {
    meta:
        id = "wM02lfb1oxL5JN3bSBeS7"
        fingerprint = "v1_sha256_6ea5b362f8d8f2e99725d4dd4d2ada5c3939a45a3dde0084571600452ab4673c"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - from files php1.txt, php7.txt, php9.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "c2f4b150f53c78777928921b3a985ec678bfae32"
        hash1 = "05a3f93dbb6c3705fd5151b6ffb64b53bc555575"
        hash2 = "cd3962b1dba9f1b389212e38857568b69ca76725"

    strings:
        $s1 = "<a href=\"?s=h&o=wscript\">[WScript.shell]</a> " fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "document.getElementById('cmd').value = Str[i];" fullword ascii
        $s3 = "Str[7] = \"copy c:\\\\\\\\1.php d:\\\\\\\\2.php\";" fullword ascii
    condition:
        filesize < 300KB and all of them
}

rule CN_Honker_Webshell__Serv_U_by_Goldsun_asp3_Serv_U_asp {
    meta:
        id = "4BNOQLtFSzmnBDDUw7VToM"
        fingerprint = "v1_sha256_b733e80f234a85a4f65eedd94f535860b4da464adb80a91afc547a8d96b5dc7a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - from files Serv-U_by_Goldsun.asp, asp3.txt, Serv-U asp.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "d4d7a632af65a961a1dbd0cff80d5a5c2b397e8c"
        hash1 = "87c5a76989bf08da5562e0b75c196dcb3087a27b"
        hash2 = "cee91cd462a459d31a95ac08fe80c70d2f9c1611"

    strings:
        $s1 = "c.send loginuser & loginpass & mt & deldomain & quit" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "loginpass = \"Pass \" & pass & vbCrLf" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "b.send \"User go\" & vbCrLf & \"pass od\" & vbCrLf & \"site exec \" & cmd & vbCr" ascii
    condition:
        filesize < 444KB and all of them
}

rule CN_Honker_Webshell__asp4_asp4_MSSQL__MSSQL_ {
    meta:
        id = "3TbQ6UpP08wMqA70H6QstX"
        fingerprint = "v1_sha256_a8ec5ad87c83c16f47391c3ce08cee74c6be1e42c288eec6d1559867d28489c6"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - from files asp4.txt, asp4.txt, MSSQL_.asp, MSSQL_.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "4005b83ced1c032dc657283341617c410bc007b8"
        hash1 = "4005b83ced1c032dc657283341617c410bc007b8"
        hash2 = "7097c21f92306983add3b5b29a517204cd6cd819"
        hash3 = "7097c21f92306983add3b5b29a517204cd6cd819"

    strings:
        $s0 = "\"<form name=\"\"searchfileform\"\" action=\"\"?action=searchfile\"\" method=\"" ascii /* PEStudio Blacklist: strings */
        $s1 = "\"<TD ALIGN=\"\"Left\"\" colspan=\"\"5\"\">[\"& DbName & \"]" fullword ascii
        $s2 = "Set Conn = Nothing " fullword ascii
    condition:
        filesize < 341KB and all of them
}

rule CN_Honker_Webshell__Injection_jmCook_jmPost_ManualInjection {
    meta:
        id = "1nd6pA4b3uqO1n7LSm1nUM"
        fingerprint = "v1_sha256_0f3a4f81326154a6a6ac448d18be29ad534917bc39aba26cc458f06b43001681"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - from files Injection.exe, jmCook.asp, jmPost.asp, ManualInjection.exe"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        super_rule = 1
        hash0 = "3484ed16e6f9e0d603cbc5cb44e46b8b7e775d35"
        hash1 = "5e1851c77ce922e682333a3cb83b8506e1d7395d"
        hash2 = "f80ec26bbdc803786925e8e0450ad7146b2478ff"
        hash3 = "e83d427f44783088a84e9c231c6816c214434526"

    strings:
        $s1 = "response.write  PostData(JMUrl,JmStr,JmCok,JmRef)" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "strReturn=Replace(strReturn,chr(43),\"%2B\")  'JMDCW" fullword ascii
    condition:
        filesize < 7342KB and all of them
}

rule CN_Honker_Webshell_cmfshell {
    meta:
        id = "3J292xrZX5uTGpnCZ5mmzK"
        fingerprint = "v1_sha256_f138a82c2d6a831626fe200308eb89cb50ffeec2f2722599eb4ccbd082bad73d"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file cmfshell.cmf"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b9b2107c946431e4ad1a8f5e53ac05e132935c0e"

    strings:
        $s1 = "<cfexecute name=\"C:\\Winnt\\System32\\cmd.exe\"" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "<form action=\"<cfoutput>#CGI.SCRIPT_NAME#</cfoutput>\" method=\"post\">" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 4KB and all of them
}

rule CN_Honker_Webshell_PHP_php4 {
    meta:
        id = "GUOdaoRHLHqcTpmumrI9o"
        fingerprint = "v1_sha256_9a58ccd5e96a41c10f7779ed89392ecbc7a3e8aba6dd4c31389e699d4d2d279d"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php4.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "179975f632baff6ee4d674fe3fabc324724fee9e"

    strings:
        $s0 = "nc -l -vv -p port(" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x4850 and filesize < 1KB and all of them
}

rule CN_Honker_Webshell_Linux_2_6_Exploit {
    meta:
        id = "1df3eJRTudWzgNYX7zQc9C"
        fingerprint = "v1_sha256_7f3e2937796358a949ce980210ddeb1a606a7b9c2b4d9c4a4acad49bb556dfc8"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file 2.6.9"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ec22fac0510d0dc2c29d56c55ff7135239b0aeee"

    strings:
        $s0 = "[+] Failed to get root :( Something's wrong.  Maybe the kernel isn't vulnerable?" fullword ascii
    condition:
        filesize < 56KB and all of them
}

rule CN_Honker_Webshell_ASP_asp2 {
    meta:
        id = "4E956QvXcT4QCg9M1ud515"
        fingerprint = "v1_sha256_6107afe9895c4e0c865e78bece160246815a0d3c589bfc79f8b369b94481cd89"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file asp2.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b3ac478e72a0457798a3532f6799adeaf4a7fc87"

    strings:
        $s1 = "<%=server.mappath(request.servervariables(\"script_name\"))%>" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "webshell</font> <font color=#00FF00>" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Userpwd = \"admin\"   'User Password" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 10KB and all of them
}

rule CN_Honker_Webshell_FTP_MYSQL_MSSQL_SSH {
    meta:
        id = "rqbrxXweTeBQk8iOjzOK6"
        fingerprint = "v1_sha256_a66884c71ce0cce05ba6607bf66dc55bfae5393746328c06f5c9ca98005d0caf"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file FTP MYSQL MSSQL SSH.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "fe63b215473584564ef2e08651c77f764999e8ac"

    strings:
        $s1 = "$_SESSION['hostlist'] = $hostlist = $_POST['hostlist'];" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Codz by <a href=\"http://www.sablog.net/blog\">4ngel</a><br />" fullword ascii
        $s3 = "if ($conn_id = @ftp_connect($host, $ftpport)) {" fullword ascii /* PEStudio Blacklist: strings */
        $s4 = "$_SESSION['sshport'] = $mssqlport = $_POST['sshport'];" fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "<title>ScanPass(FTP/MYSQL/MSSQL/SSH) by 4ngel</title>" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 20KB and 3 of them
}

rule CN_Honker_Webshell_ASP_shell {
    meta:
        id = "6KwjAJWCqwr4hcGheob8Iz"
        fingerprint = "v1_sha256_be3961d6568acfaadfa09efda2f914259a59f4e30725c7d434e89f6020e40515"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file shell.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "b7b34215c2293ace70fc06cbb9ce73743e867289"

    strings:
        $s1 = "xPost.Open \"GET\",\"http://www.i0day.com/1.txt\",False //" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "sGet.SaveToFile Server.MapPath(\"test.asp\"),2 //" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "http://hi.baidu.com/xahacker/fuck.txt" fullword ascii
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_Webshell_PHP_php7 {
    meta:
        id = "2QURSvcgX4sSH7XTbSzKoQ"
        fingerprint = "v1_sha256_70804d914c6f31422632943bf663f997eb747a290a13b27bfcc66bc3129f136d"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file php7.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "05a3f93dbb6c3705fd5151b6ffb64b53bc555575"

    strings:
        $s0 = "---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; }" ascii /* PEStudio Blacklist: strings */
        $s1 = "$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = iss" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 300KB and all of them
}

rule CN_Honker_Webshell_ASP_rootkit {
    meta:
        id = "u61cw9Dqe5H927cEnN8a"
        fingerprint = "v1_sha256_5569a179f011ece9802676542d5556fe8d2a2b144e26065b9e0c5bd06c970201"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file rootkit.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3bfc1c95782e702cf56184e7d438edcf5802eab3"

    strings:
        $s0 = "set ss=zsckm.get(\"Win32_ProcessSta\"&uyy&\"rtup\")" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "If jzgm=\"\"Then jzgm=\"cmd.exe /c net user\"" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 80KB and all of them
}

rule CN_Honker_Webshell_jspshell {
    meta:
        id = "34uTExgZQSbbtJ4633mEO8"
        fingerprint = "v1_sha256_9b952f941eb87d7a1b4f747f4e0b0b5ee8876190c6f684b811057a2c78044047"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file jspshell.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "d16af622f7688d4e0856a2678c4064d3d120e14b"

    strings:
        $s1 = "else if(Z.equals(\"M\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Proce" ascii /* PEStudio Blacklist: strings */
        $s2 = "String Z=EC(request.getParameter(Pwd)+\"\",cs);String z1=EC(request.getParameter" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 30KB and all of them
}

rule CN_Honker_Webshell_Serv_U_serv_u {
    meta:
        id = "2umWDnP8AOiGGzfT3UvnrU"
        fingerprint = "v1_sha256_18afbfe4f7aefa64ddf2852fefba962cec6b6ab34ffc86259f8e03d90c1a5d71"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file serv-u.php"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "1c6415a247c08a63e3359b06575b36017befc0c0"

    strings:
        $s1 = "@readfile(\"c:\\\\winnt\\\\system32\\" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "$sendbuf = \"PASS \".$_POST[\"password\"].\"\\r\\n\";" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "$cmd=\"cmd /c rundll32.exe $path,install $openPort $activeStr\";" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 435KB and all of them
}

rule CN_Honker_Webshell_WebShell {
    meta:
        id = "6wTRLtcT2Fd8vWqScgUJtI"
        fingerprint = "v1_sha256_7d80390a86b1858d2cf4f2be56df7e734aea402de0878adf40ef36721719ca74"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file WebShell.cgi"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7ef773df7a2f221468cc8f7683e1ace6b1e8139a"

    strings:
        $s1 = "$login = crypt($WebShell::Configuration::password, $salt);" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "my $error = \"This command is not available in the restricted mode.\\n\";" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "warn \"command: '$command'\\n\";" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 30KB and 2 of them
}

rule CN_Honker_Webshell_Tuoku_script_mssql_2 {
    meta:
        id = "6tmThBVJhBFeyzYRoMsLZD"
        fingerprint = "v1_sha256_1d4b75eeeddda6e92b8ec38679d5e2b9d21abf2d2b467b91a066dcf628725f0a"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file mssql.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ad55512afa109b205e4b1b7968a89df0cf781dc9"

    strings:
        $s1 = "sqlpass=request(\"sqlpass\")" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "set file=fso.createtextfile(server.mappath(request(\"filename\")),8,true)" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "<blockquote> ServerIP:&nbsp;&nbsp;&nbsp;" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 3KB and all of them
}

rule CN_Honker_Webshell_ASP_asp1 {
    meta:
        id = "4DQnuCJaDZudbJgKnZM4Az"
        fingerprint = "v1_sha256_3b454b1254d05b2208aee02e966c9c56a338dd3d33a2c6acc2c4df3208314055"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Webshell from CN Honker Pentest Toolset - file asp1.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "78b5889b363043ed8a60bed939744b4b19503552"

    strings:
        $s1 = "SItEuRl=" ascii
        $s2 = "<%@ LANGUAGE = VBScript.Encode %><%" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "Server.ScriptTimeout=" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 200KB and all of them
}
