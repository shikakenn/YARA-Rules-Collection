/*
    Yara Rule Set
    Author: Florian Roth
    Date: 2015-06-23
    Identifier: CN-PentestSet
*/

rule CN_Honker_mafix_root {
    meta:
        id = "4XFgkEzTPb0kohrL7o2tOA"
        fingerprint = "v1_sha256_db54561ba4b9c1bd4d9b183658b98f6fd3165b05c8d6d7f006ae3b5fc96ba549"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file root"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "826778ef9c22177d41698b467586604e001fed19"

    strings:
        $s0 = "echo \"# vbox (voice box) getty\" >> /tmp/.init1" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "cp /var/log/tcp.log $HOMEDIR/.owned/bex2/snifflog" fullword ascii
        $s2 = "if [ -f /sbin/xlogin ]; then" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 96KB and all of them
}

rule CN_Honker_passwd_dict_3389 {
    meta:
        id = "63e1AQIynh3otDIxsjO8YN"
        fingerprint = "v1_sha256_07ed48f6ee31e6be7e893d61f6f3e48d498c73d88edc55eb1a3a4daabb6d52a9"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file 3389.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2897e909e48a9f56ce762244c3a3e9319e12362f"

    strings:
        $s0 = "654321" fullword ascii /* reversed goodware string '123456' */
        $s1 = "admin123" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "admin123456" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "administrator" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 2 times */
        $s4 = "passwd" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 42 times */
        $s5 = "password" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 244 times */
        $s7 = "12345678" fullword ascii /* Goodware String - occured 29 times */
        $s8 = "888888" fullword ascii /* Goodware String - occured 61 times */
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_Perl_serv_U {
    meta:
        id = "PqhpJel8naNeQG2tTlrGh"
        fingerprint = "v1_sha256_deb4ee54f9127bc093f96f7dbf3633fbfc3f66358c76fb15928dabbbffdd4963"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file Perl-serv-U.pl"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f333c597ff746ebd5a641fbc248497d61e3ec17b"

    strings:
        $s1 = "$dir = 'C:\\\\WINNT\\\\System32\\\\';" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "$sock = IO::Socket::INET->new(\"127.0.0.1:$adminport\") || die \"fail\";" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 8KB and all of them
}

rule CN_Honker_F4ck_Team_f4ck {
    meta:
        id = "2ySwBXubux7kpCIBApmzn3"
        fingerprint = "v1_sha256_be4817bcaae952eb13c35dd89606ec733c682b2e197054bb348c3934012bd105"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file f4ck.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e216f4ba3a07de5cdbb12acc038cd8156618759e"

    strings:
        $s0 = "PassWord:F4ckTeam!@#" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "UserName:F4ck" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "F4ck Team" fullword ascii
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_sig_3389_3389 {
    meta:
        id = "vwGfWV3kyBi1SEe19iBjj"
        fingerprint = "v1_sha256_32603edd3f188a9f4919795df04112883d7b88da46b13fcd0b0e0065fd4c016b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file 3389.vbs"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "f92b74f41a2138cc05c6b6993bcc86c706017e49"

    strings:
        $s1 = "success = obj.run(\"cmd /c takeown /f %SystemRoot%\\system32\\sethc.exe&echo y| " ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 10KB and all of them
}

rule CN_Honker_sig_3389_3389_2 {
    meta:
        id = "58R6dPjknYWRke9GZmzjZd"
        fingerprint = "v1_sha256_637b3368fac624ca78d2f573b8b937b6b265426d7ed923f3a3d06039663c97ad"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file 3389.bat"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5ff92f39ade12f8ba6cb75dfdc9bb907e49f0ebd"

    strings:
        $s1 = "@del c:\\termsrvhack.dll" fullword ascii
        $s2 = "@del c:\\3389.txt" fullword ascii
    condition:
        filesize < 3KB and all of them
}

rule CN_Honker_Injection_Transit_jmCook {
    meta:
        id = "20iupCgcPs06GDskZbOiQC"
        fingerprint = "v1_sha256_f7a9aca65b92d4b9c787d83a421b54a23844fa8e061c6c627ddde8ab5b7f4396"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file jmCook.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5e1851c77ce922e682333a3cb83b8506e1d7395d"

    strings:
        $s1 = ".Open \"POST\",PostUrl,False" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "JmdcwName=request(\"jmdcw\")" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 9KB and all of them
}

rule CN_Honker_Pwdump7_Pwdump7 {
    meta:
        id = "jj1qKSJWKAjeoFWmTIws0"
        fingerprint = "v1_sha256_50e4ec9716b4e9d824fb301bb493dcdcd9782d87c0fb8040b82a87faf56292cb"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file Pwdump7.bat"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "67d0e215c96370dcdc681bb2638703c2eeea188a"

    strings:
        $s1 = "Pwdump7.exe >pass.txt" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_portRecall_pr {
    meta:
        id = "3JfeaOYLl52s33NgkIgbDQ"
        fingerprint = "v1_sha256_f33373e87887506651b1fac464f860a3cf18ad681ba124b606524f6f2255e693"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file pr"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "583cf6dc2304121d835f2879803a22fea76930f3"

    strings:
        $s1 = "Usage: Same as lcx.exe in win32 :)" fullword ascii
        $s2 = "connect to client" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "PR(Packet redirection) for linux " fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 70KB and all of them
}

rule CN_Honker_sig_3389_3389_3 {
    meta:
        id = "3VF6pTFE6hP430p2765xET"
        fingerprint = "v1_sha256_df07958e44c7896bc7bdf2b79bc95969593eb21b9c9ed51213fd15affb731ec2"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file 3389.bat"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "cfedec7bd327897694f83501d76063fe16b13450"

    strings:
        $s1 = "echo \"fDenyTSConnections\"=dword:00000000>>3389.reg " fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "echo \"PortNumber\"=dword:00000d3d>>3389.reg " fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "echo [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server]>>" ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 2KB and all of them
}

rule CN_Honker_Alien_D {
    meta:
        id = "2LHcA7yadmaGBAfxlIBX68"
        fingerprint = "v1_sha256_2eca697dd1f2ad80c5cd71507cd5f8abd2364b11dfe3206a1043e3d4f5835797"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file D.ASP"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "de9cd4bd72b1384b182d58621f51815a77a5f07d"

    strings:
        $s0 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr" ascii /* PEStudio Blacklist: strings */
        $s1 = "CONST_FSO=\"Script\"&\"ing.Fil\"&\"eSyst\"&\"emObject\"" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "Response.Write \"<form id='form1' name='form1' method='post' action=''>\"" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "set getAtt=FSO.GetFile(filepath)" fullword ascii
        $s4 = "Response.Write \"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' chec" ascii
    condition:
        filesize < 30KB and 2 of them
}

rule CN_Honker_ChinaChopper_db {
    meta:
        id = "4bMyClgui2nYDJ7F4Sx3EW"
        fingerprint = "v1_sha256_b650498df99c4620e3904ce8980cd58eb0cb5e0a7a275d54bdbcc41a687bec8e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file db.mdb"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "af79ff2689a6b7a90a5d3c0ebe709e42f2a15597"

    strings:
        $s1 = "http://www.maicaidao.com/server.phpcaidao" fullword wide /* PEStudio Blacklist: strings */
        $s2 = "<O>act=login</O>" fullword wide /* PEStudio Blacklist: strings */
        $s3 = "<H>localhost</H>" fullword wide /* PEStudio Blacklist: strings */
    condition:
        filesize < 340KB and 2 of them
}

rule CN_Honker_syconfig {
    meta:
        id = "4OkDWdYwgsFDYbmNT7jNnK"
        fingerprint = "v1_sha256_6b7f918b83bac84df5ac6b247d4162dd385aba0a32570366c62fc4830199e86e"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file syconfig.dll"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "ff75353df77d610d3bccfbffb2c9dfa258b2fac9"

    strings:
        $s9 = "Hashq.CrackHost+FormUnit" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x0100 and filesize < 18KB and all of them
}

rule CN_Honker_linux_bin {
    meta:
        id = "3O505jxnTXZycld2kNUIj5"
        fingerprint = "v1_sha256_d02fcf23e46a0b6d44c382e34d73ef6239b6a1afc690e417aa0e6b0898e277c0"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file linux_bin"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "26e71e6ebc6a3bdda9467ce929610c94de8a7ca0"

    strings:
        $s1 = "client.sin_port = htons(atoi(argv[3]));" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "printf(\"\\n\\n*********Waiting Client connect*****\\n\\n\");" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 20KB and all of them
}

rule CN_Honker_Intersect2_Beta {
    meta:
        id = "DRYp8Sqo2S2W9MBHPYiJN"
        fingerprint = "v1_sha256_bc6a83f8f851f7fb5b620be889619fcbd9f34ba27d495c2040e207caf95854bb"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file Intersect2-Beta.py"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "3ba5f720c4994cd4ad519b457e232365e66f37cc"

    strings:
        $s1 = "os.system(\"ls -alhR /home > AllUsers.txt\")" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "os.system('getent passwd > passwd.txt')" fullword ascii /* PEStudio Blacklist: strings */
        $s3 = "os.system(\"rm -rf credentials/\")" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        uint16(0) == 0x2123 and filesize < 50KB and 2 of them
}

rule CN_Honker_IIS_logcleaner1_0_readme {
    meta:
        id = "QO8MLFfm2Nm45vTQZjudG"
        fingerprint = "v1_sha256_3cbd7b2e1710c78bc8ab8d2730cc6da8eb95038f8431d5d0081db984b3d706cf"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file readme.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2ab47d876b49e9a693f602f3545381415e82a556"

    strings:
        $s2 = "LogCleaner.exe <ip> [Logpath]" fullword ascii
        $s3 = "http://l-y.vicp.net" fullword ascii
    condition:
        filesize < 7KB and all of them
}

rule CN_Honker_Alien_command {
    meta:
        id = "1F9lQTHxGeY2cC9oWNaC34"
        fingerprint = "v1_sha256_a55be30fdb6598669d144308af5a9b6a21ab6140c75fdfc18cecf5d9add4a530"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file command.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "5896b74158ef153d426fba76c2324cd9c261c709"

    strings:
        $s0 = "for /d %i in (E:\\freehost\\*) do @echo %i" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "/c \"C:\\windows\\temp\\cscript\" C:\\windows\\temp\\iis.vbs" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 8KB and all of them
}

rule CN_Honker_portRecall_bc {
    meta:
        id = "6MuCN9e5IZoA0WMeUVHasS"
        fingerprint = "v1_sha256_f51644f195e42b91dae80ba1770aeb40790ea8528b6d09f5fed0f71d93bda5fc"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file bc.pl"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "2084990406398afd856b2309c7f579d7d61c3767"

    strings:
        $s0 = "print \"[*] Connected to remote host \\n\"; " fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "print \"Usage: $0 [Host] [Port] \\n\\n\";  " fullword ascii /* PEStudio Blacklist: strings */
        $s5 = "print \"[*] Resolving HostName\\n\"; " fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 10KB and all of them
}

rule CN_Honker_Tuoku_script_MSSQL_ {
    meta:
        id = "3z2YfDCt4DvifgJh1Z2HBi"
        fingerprint = "v1_sha256_4d721fd9711799cf3fd8ba6c300e270ed25faa2fb938ea01464e9bc9a3768e22"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file MSSQL_.asp"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "7097c21f92306983add3b5b29a517204cd6cd819"

    strings:
        $s1 = "GetLoginCookie = Request.Cookies(Cookie_Login)" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "if ShellPath=\"\" Then ShellPath = \"c:\\\\windows\\\\system32\\\\cmd.exe\"" fullword ascii /* PEStudio Blacklist: strings */
        $s8 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 100KB and all of them
}

rule CN_Honker_nc_MOVE {
    meta:
        id = "2fKoqoHuCkvCyhP7Rhrfns"
        fingerprint = "v1_sha256_49f41162919bb04744041ae6f7438e61d98fb7d5984a17535d9c4ce4d398671b"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file MOVE.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "4195370c103ca467cddc8f2724a8e477635be424"

    strings:
        $s0 = "Destination: http://202.113.20.235/gj/images/2.asp" fullword ascii /* PEStudio Blacklist: strings */
        $s1 = "HOST: 202.113.20.235" fullword ascii /* PEStudio Blacklist: strings */
        $s2 = "MOVE /gj/images/A.txt HTTP/1.1" fullword ascii
    condition:
        filesize < 1KB and all of them
}

rule CN_Honker_mssqlpw_scan {
    meta:
        id = "14wn7IqyalZpgmkhTesnXy"
        fingerprint = "v1_sha256_eb3bd38ca317f0b10358581fc3dbb8ca81b991b9a4f4f2d256d81a31028411b9"
        version = "1.0"
        score = 70
        date = "2015-06-23"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Script from disclosed CN Honker Pentest Toolset - file mssqlpw scan.txt"
        category = "INFO"
        reference = "Disclosed CN Honker Pentest Toolset"
        hash = "e49def9d72bfef09a639ef3f7329083a0b8b151c"

    strings:
        $s0 = "response.Write(\"I Get it ! Password is <font color=red>\" & str & \"</font><BR>" ascii /* PEStudio Blacklist: strings */
        $s1 = "response.Write \"Done!<br>Process \" & tTime & \" s\"" fullword ascii /* PEStudio Blacklist: strings */
    condition:
        filesize < 6KB and all of them
}
