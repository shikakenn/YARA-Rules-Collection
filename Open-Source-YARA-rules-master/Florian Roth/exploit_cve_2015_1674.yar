/*
    Yara Rule Set
    Author: Florian Roth
    Date: 2015-05-14
    Identifier: CVE-2015-1674
*/

/* Rule Set ----------------------------------------------------------------- */

rule CVE_2015_1674_CNGSYS {
    meta:
        id = "6cvURtuFZ0aFzlaU3MHGLJ"
        fingerprint = "v1_sha256_44f4bd887b8a0b4b60f8bf98ec528bb869bf1d1dda3a3bd7fae8f1444b97ef11"
        version = "1.0"
        date = "2015-05-14"
        modified = "2025-03-10"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "YARA-RULES-COLLECTION"
        author = "Florian Roth"
        description = "Detects exploits for CVE-2015-1674"
        category = "INFO"
        reference = "http://www.binvul.com/viewthread.php?tid=508"
        hash = "af4eb2a275f6bbc2bfeef656642ede9ce04fad36"

    strings:
        $s1 = "\\Device\\CNG" fullword wide
        
        $s2 = "GetProcAddress" fullword ascii
        $s3 = "LoadLibrary" ascii
        $s4 = "KERNEL32.dll" fullword ascii
        $s5 = "ntdll.dll" fullword ascii
    condition:
        uint16(0) == 0x5a4d and filesize < 60KB and all of them
}

