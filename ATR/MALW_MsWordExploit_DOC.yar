rule msworldexploit_builder_doc {

    meta:
        id = "2Q3pR6xie3IdBVxD6wDcJh"
        fingerprint = "v1_sha256_f85c6d79e5ed20084d35f9de92a9d9ce20cf4b3100b1226d64147e366934585d"
        version = "1.0"
        modified = "2025-02-27"
        status = "RELEASED"
        sharing = "TLP:WHITE"
        source = "ATR"
        author = "Marc Rivero | McAfee ATR Team"
        description = "Rule to detect RTF/Docs files created by MsWordExploit Builder"
        category = "INFO"
        rule_version = "v1"
        malware_family = "Maldoc:W32/MSwordExploit"
        actor_group = "Unknown"

  strings:

        //http://api.mswordexploit.com	
      $s1 = { 68 74 74 70 3A 2F 2F 61 70 69 2E 6D 73 77 6F 72 64 65 78 70 6C 6F 69 74 2E 63 6F 6D } 
      $s2 = "{\\*\\generator mswordexploit 6.3.9600}" fullword ascii

   condition:
   
    uint16(0) == 0x3030 and
    filesize < 4000KB and
      any of them 
}
